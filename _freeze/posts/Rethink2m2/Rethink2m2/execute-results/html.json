{
  "hash": "c54a301e85fcd4a4ba04b2e973bbe519",
  "result": {
    "engine": "knitr",
    "markdown": "---\nextype: string\nexsolution: NA\nexname: rethink2m2\nexpoints: 1\ncategories:\n- probability\n- bayes-grid\n- bayes\n- rethink-chap2\n- string\ndate: '2023-11-08'\nslug: Rethink2m2\ntitle: Rethink2m2\n\n---\n\n\n\n\n\n\n\n\n\n\n\n\n\n# Aufgabe\n\nThis question is taken from McElreath, R. (2020). *Statistical rethinking: A Bayesian course with examples in R and Stan* (2. Ed.). Taylor and Francis, CRC Press.\n\n\nRecall the globe tossing model from the chapter. Compute and plot the grid approximate posterior distribution for each of the following sets of observations. In each case, assume a uniform prior for *p*.\n\nData: \n\n1. WWW\n2. WWWL\n3. LWWLWWW\n\n\nNow assume a prior for p that is equal to zero when p < 0.5 and is a positive constant when p ≥ 0.5. Again compute and plot the grid approximate posterior distribution for each of the sets of observations in the problem just above.\n\n\nNB:\n\n- Consider 21 different values for *p* such that $p = (0, .05, 1., .15, \\ldots, 1)$.\n- Round to 2 decimal places.\n\n\n\n\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n\n# Lösung\n\nThe solution is taken from [this source](https://sr2-solutions.wjakethompson.com/bayesian-inference.html).\n\n\n\n::: {.cell hash='Rethink2m2_cache/html/unnamed-chunk-1_76f06186df387c524c28c7e175b2e115'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\ndist <- \n  tibble(\n    # Gridwerte bestimmen:\n    p_grid = seq(from = 0, to = 1, length.out = 21),\n    # Priori-Wskt bestimmen:\n    prior  = case_when(\n      p_grid < 0.5 ~ 0,\n      p_grid >= 0.5 ~ 1)) %>%\n  mutate(\n    # Likelihood berechnen:\n    likelihood_1 = dbinom(3, size = 3, prob = p_grid),\n    likelihood_2 = dbinom(3, size = 4, prob = p_grid),\n    likelihood_3 = dbinom(5, size = 7, prob = p_grid),\n    # unstand. Posterior-Wskt:\n    unstand_post_1 = likelihood_1 * prior,\n    unstand_post_2 = likelihood_2 * prior,\n    unstand_post_3 = likelihood_3 * prior,\n    # stand. Post-Wskt:\n    std_post_1 = unstand_post_1 / sum(unstand_post_1),\n    std_post_2 = unstand_post_2 / sum(unstand_post_2),\n    std_post_3 = unstand_post_3 / sum(unstand_post_3)\n    ) \n```\n:::\n\n\nHere is the Bayes Box:\n\n\n::: {.cell hash='Rethink2m2_cache/html/unnamed-chunk-2_51dea1f00addde69c2595ca53716d623'}\n::: {.cell-output-display}\n\n\n| p_grid| prior| likelihood_1| likelihood_2| likelihood_3| unstand_post_1| unstand_post_2| unstand_post_3| std_post_1| std_post_2| std_post_3|\n|------:|-----:|------------:|------------:|------------:|--------------:|--------------:|--------------:|----------:|----------:|----------:|\n|   0.00|     0|         0.00|         0.00|         0.00|           0.00|           0.00|           0.00|       0.00|       0.00|       0.00|\n|   0.05|     0|         0.00|         0.00|         0.00|           0.00|           0.00|           0.00|       0.00|       0.00|       0.00|\n|   0.10|     0|         0.00|         0.00|         0.00|           0.00|           0.00|           0.00|       0.00|       0.00|       0.00|\n|   0.15|     0|         0.00|         0.01|         0.00|           0.00|           0.00|           0.00|       0.00|       0.00|       0.00|\n|   0.20|     0|         0.01|         0.03|         0.00|           0.00|           0.00|           0.00|       0.00|       0.00|       0.00|\n|   0.25|     0|         0.02|         0.05|         0.01|           0.00|           0.00|           0.00|       0.00|       0.00|       0.00|\n|   0.30|     0|         0.03|         0.08|         0.03|           0.00|           0.00|           0.00|       0.00|       0.00|       0.00|\n|   0.35|     0|         0.04|         0.11|         0.05|           0.00|           0.00|           0.00|       0.00|       0.00|       0.00|\n|   0.40|     0|         0.06|         0.15|         0.08|           0.00|           0.00|           0.00|       0.00|       0.00|       0.00|\n|   0.45|     0|         0.09|         0.20|         0.12|           0.00|           0.00|           0.00|       0.00|       0.00|       0.00|\n|   0.50|     1|         0.13|         0.25|         0.16|           0.13|           0.25|           0.16|       0.02|       0.07|       0.07|\n|   0.55|     1|         0.17|         0.30|         0.21|           0.17|           0.30|           0.21|       0.03|       0.09|       0.10|\n|   0.60|     1|         0.22|         0.35|         0.26|           0.22|           0.35|           0.26|       0.04|       0.10|       0.12|\n|   0.65|     1|         0.27|         0.38|         0.30|           0.27|           0.38|           0.30|       0.05|       0.11|       0.13|\n|   0.70|     1|         0.34|         0.41|         0.32|           0.34|           0.41|           0.32|       0.07|       0.12|       0.14|\n|   0.75|     1|         0.42|         0.42|         0.31|           0.42|           0.42|           0.31|       0.08|       0.13|       0.14|\n|   0.80|     1|         0.51|         0.41|         0.28|           0.51|           0.41|           0.28|       0.10|       0.12|       0.12|\n|   0.85|     1|         0.61|         0.37|         0.21|           0.61|           0.37|           0.21|       0.12|       0.11|       0.09|\n|   0.90|     1|         0.73|         0.29|         0.12|           0.73|           0.29|           0.12|       0.14|       0.09|       0.06|\n|   0.95|     1|         0.86|         0.17|         0.04|           0.86|           0.17|           0.04|       0.16|       0.05|       0.02|\n|   1.00|     1|         1.00|         0.00|         0.00|           1.00|           0.00|           0.00|       0.19|       0.00|       0.00|\n\n\n:::\n:::\n\n\n\nJetzt können wir das Diagramm zeichnen.\n\nMit `ggpubr`:\n\n\n\n::: {.cell hash='Rethink2m2_cache/html/unnamed-chunk-3_3b0d0a25ad2bc09b9de1783884806a3b'}\n\n```{.r .cell-code}\nlibrary(ggpubr)\nggline(dist, \n       x = \"p_grid\", \n       y = \"std_post_1\")\n```\n\n::: {.cell-output-display}\n![](unnamed-chunk-3-1.png){fig-pos='H' width=384}\n:::\n:::\n\n\n\nOder mit `ggplot2`:\n\n\n\n::: {.cell hash='Rethink2m2_cache/html/unnamed-chunk-4_efa6eeed1a9ec6b3a173965428ac9095'}\n\n```{.r .cell-code}\nggplot(dist) +\n  aes(x = p_grid, y= std_post_1) +\n  geom_line()+\n  geom_point() +\n  labs(x = \"p(W)\",\n       y = \"Posteriori-Wahrscheinlichkeit\",\n       title = \"Daten: WWW\")\n```\n\n::: {.cell-output-display}\n![](unnamed-chunk-4-1.png){fig-pos='H' width=384}\n:::\n:::\n\n::: {.cell hash='Rethink2m2_cache/html/unnamed-chunk-5_4f2e68bf2cf4df711548c62d552c3b0e'}\n\n```{.r .cell-code}\nggplot(dist) +\n  aes(x = p_grid, y= std_post_2) +\n  geom_line()+\n  geom_point() +\n  labs(x = \"p(W)\",\n       y = \"Posteriori-Wahrscheinlichkeit\",\n       title = \"Daten: WWWL\")\n```\n\n::: {.cell-output-display}\n![](unnamed-chunk-5-1.png){fig-pos='H' width=384}\n:::\n:::\n\n::: {.cell hash='Rethink2m2_cache/html/unnamed-chunk-6_5722a881a7460e5c54a94b230f93d7fb'}\n\n```{.r .cell-code}\nggplot(dist) +\n  aes(x = p_grid, y= std_post_3) +\n  geom_line()+\n  geom_point() +\n  labs(x = \"p(W)\",\n       y = \"Posteriori-Wahrscheinlichkeit\",\n       title = \"Daten: LWWLWWW\")\n```\n\n::: {.cell-output-display}\n![](unnamed-chunk-6-1.png){fig-pos='H' width=384}\n:::\n:::\n\n\n\n\n\n\n\n---\n\nCategories: \n\n- probability\n- bayes-grid\n- bayes\n- rethink-chap2\n- string\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}