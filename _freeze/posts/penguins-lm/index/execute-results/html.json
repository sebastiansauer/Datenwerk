{
  "hash": "1238cb736e7a4bd666260ecdc7d578e9",
  "result": {
    "engine": "knitr",
    "markdown": "---\n# gleich diese Datei in einem Ordner mit Namen der Aufgabe abspeichern!\ndate: 2024-09-12  # HEUTIGES DATUM EINTRAGEN, nicht \"today\"\ndraft: FALSE   # ACHTUNG DRAFT STEHT AUF TRUE!\ntitle: penguins-lm  # HIER TITEL DES POSTS EINGEBEN.\nexecute: \n  \n  eval: true \nhighlight-style: arrow \ncache: true\ntoc: true\nnumber-sections: true\nextype: string\nexsolution: \"\"\nexshuffle: no\ncategories:\n- lm  # ENTER CATEGORIES HERE\n- en\n- regression\n- penguins\n\n\nbibliography: \"../../library-ses.bib\"\n\n\n---\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n# Exercise\n\n\nConsider the dataset `penguins`. Compute a linear model with body mass as output variable (DV) and flipper length as input (IV). \n\n1. Report the coefficients and interpret them.\n2. Plot the model and the coefficients.\n3. Report the model fit (R squared).\n4. BONUS: `predict()` the weight of an average flipper-sized animal.  Check out the internet for examples of how to do so in case you need support.\n\n\n\n\n# Solution\n\n## Setup\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(easystats)\nlibrary(ggpubr)\n\n# import data:\npenguins <- read.csv(\"https://vincentarelbundock.github.io/Rdatasets/csv/palmerpenguins/penguins.csv\")\n```\n:::\n\n\n\n\n## Let's go\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm1 <- lm(body_mass_g ~ flipper_length_mm, data = penguins)\n```\n:::\n\n\n\n\nPlot the model:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(estimate_relation(lm1))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n\nAlternative plotting method:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggscatter(penguins,\n          x = \"flipper_length_mm\",\n          y = \"body_mass_g\",\n          add =\"reg.line\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n\nCoefficients (parameters):\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nparameters(lm1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nParameter         | Coefficient |     SE |               95% CI | t(340) |      p\n---------------------------------------------------------------------------------\n(Intercept)       |    -5780.83 | 305.81 | [-6382.36, -5179.30] | -18.90 | < .001\nflipper length mm |       49.69 |   1.52 | [   46.70,    52.67] |  32.72 | < .001\n```\n\n\n:::\n:::\n\n\n\n\nPlot the coefficients:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(parameters(lm1))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n\nModel fit (explained variance by model):\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nr2(lm1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# R2 for Linear Regression\n       R2: 0.759\n  adj. R2: 0.758\n```\n\n\n:::\n:::\n\n\n\n\nPredict weight of average animal:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |> \n  summarise(flipper_length_mm_avg = \n              mean(flipper_length_mm, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  flipper_length_mm_avg\n1                   201\n```\n\n\n:::\n:::\n\n\n\n## For average flipper length, what's the expected weight?\n\n\n::: {.cell}\n\n```{.r .cell-code}\npredict(lm1, newdata = data.frame(flipper_length_mm = 200))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   1 \n4156 \n```\n\n\n:::\n:::\n\n\nAround 4 kgs.\n\n\n## Centering the data\n\n\nCenter the data:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins_c <-\n  penguins |> \n  mutate(flipper_length_mm_c = center(flipper_length_mm))\n```\n:::\n\n\n\nNow the mean value is (nearly) zero:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean(penguins_c$flipper_length_mm_c, na.rm = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -1.2e-14\n```\n\n\n:::\n:::\n\n\n\nRun the model again:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm2 <- lm(body_mass_g ~ flipper_length_mm_c, data = penguins_c)\n\nparameters(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nParameter           | Coefficient |    SE |             95% CI | t(340) |      p\n--------------------------------------------------------------------------------\n(Intercept)         |     4201.75 | 21.32 | [4159.82, 4243.69] | 197.08 | < .001\nflipper length mm c |       49.69 |  1.52 | [  46.70,   52.67] |  32.72 | < .001\n```\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}