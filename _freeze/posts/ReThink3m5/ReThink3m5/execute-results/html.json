{
  "hash": "0eb6fcd514dc604fca58bbebe906c618",
  "result": {
    "engine": "knitr",
    "markdown": "---\nextype: string\nexsolution: NA\nexname: rethink3m5\nexpoints: 1\ncategories:\n- bayes\n- ppv\n- probability\n- string\ndate: '2023-11-08'\nslug: ReThink3m5\ntitle: ReThink3m5\n\n---\n\n---\noutput: html_document\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n\n\n\n\n\n\n\n\n\n\n# Aufgabe\n\n\n\n\n\nNehmen wir an, wir haben 8 (Wasser-)\"Treffer\" ($W=8$) bei 15 Würfen ($N=15$) erhalten (wieder im Globusversuch).\n\n\nNehmen Sie dieses Mal *keine* gleichverteilte Priori-Verteilung an. Stattdessen verwenden Sie einen Priori-Wert von Null solange $p < 0.5$ und einen konstanten Wert für $p \\ge 0.5$. Diese Priori-Verteilung kodiert die Information, dass mindestens die Hälfte der Erdoberfläche mit Sicherheit aus Wasser besteht. \n\nFür alle folgenden Berechnungen, vergleichen Sie Ihre Ergebnisse zu der analogen Analyse mit einem konstanten (gleichverteilten) Priori-Wert!\n\na) Berechnen Sie die Posteriori-Verteilung und visualisieren Sie sie. Nutzen Sie die Gittermethode.\n\nb) Ziehen Sie $10^4$ Stichproben aus der Posteriori-Verteilung, die Sie mit der Gittermethode erhalten haben. Berechnen Sie auf dieser Grundlage das 90%-HDI.\n\nc) Berechnen Sie die PPV für dieses Modell. Was ist die Wahrscheinlichkeit 8 von 15 Treffer zu erzielen laut dieser PPV?\n\nd) Auf Basis der aktuellen Posteriori-Wahrscheinlichkeit: Was ist die Wahrscheinlichkeit für 6 Wasser bei 9 Würfen?\n\n\nHinweise:\n\n- Berechnen Sie eine Bayes-Box (Gittermethode).\n- Verwenden Sie 1000 Gitterwerte.\n- Fixieren Sie die Zufallszahlen mit dem Startwert 42, d.h. `set.seed(42)`.\n- Gehen Sie von einem gleichverteilten Prior aus.\n\n\n\n*Quelle*: McElreath, R. (2020). *Statistical rethinking: A Bayesian course with examples in R and Stan* (2. Aufl.). Taylor and Francis, CRC Press.\n\n\n\n\n\n\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n\n# Lösung\n\n\na) Berechnen Sie die Posteriori-Verteilung und visualisieren Sie sie. Nutzen Sie die Gittermethode.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\np_grid <- seq(from = 0, to = 1, length.out = 1000)\nprior <- case_when(\n  p_grid <  0.5 ~ 0,\n  p_grid >= 0.5 ~ 1)\nlikelihood <- dbinom(8, size = 15, prob = p_grid)\nunstand_posterior <- likelihood * prior\nposterior <- unstand_posterior / sum(unstand_posterior)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntibble(p = p_grid, \n       posterior = posterior) %>%\n  ggplot(aes(x = p, y = posterior)) +\n # geom_point() +\n  geom_line() +\n  labs(x = \"Proportion Water (p)\", y = \"Posterior Density\")\n```\n\n::: {.cell-output-display}\n![](post-vert-p-1.png){fig-pos='H' width=50%}\n:::\n:::\n\n\nAlternativ können Sie mit `ggpubr::ggline()` visualisieren.\n\nb) Ziehen Sie $10^4$ Stichproben aus der Posteriori-Verteilung, die Sie mit der Gittermethode erhalten haben. Berechnen Sie auf dieser Grundlage das 90%-HDI.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(easystats)\n# Stichproben (samples) aus der Posteriori-Verteilung:\nsamples <- sample(p_grid, prob = posterior, size = 1e4, replace = TRUE)\nhdi(samples, prob = 0.9)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n95% HDI: [0.50, 0.75]\n```\n\n\n:::\n:::\n\n\n\nc) Berechnen Sie die PPV für dieses Modell. Was ist die Wahrscheinlichkeit 8 von 15 Treffer zu erzielen laut dieser PPV?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nPPV <-\n  tibble(w = rbinom(1e4, size = 15, prob = samples))  # w wie Wasser\n\nPPV %>% \n  count(w == 8) %>% \n  mutate(prop = n/sum(n))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 3\n  `w == 8`     n  prop\n  <lgl>    <int> <dbl>\n1 FALSE     8508 0.851\n2 TRUE      1492 0.149\n```\n\n\n:::\n:::\n\n\n\n\nd) Auf Basis der aktuellen Posteriori-Wahrscheinlichkeit: Was ist die Wahrscheinlichkeit für 6 Wasser bei 9 Würfen?\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nPPV <-\n  PPV %>% \n  mutate(w2 = rbinom(1e4, size = 9, prob = samples))\n\nPPV %>% \n  count(w2 == 6) %>% \n  mutate(prop = n/sum(n))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 3\n  `w2 == 6`     n  prop\n  <lgl>     <int> <dbl>\n1 FALSE      7738 0.774\n2 TRUE       2262 0.226\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n---\n\nCategories: \n\n- bayes\n- ppv\n- probability\n- string\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}