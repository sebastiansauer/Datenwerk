{
  "hash": "ef8c64679f94e28dabc06de16c664bc1",
  "result": {
    "markdown": "---\nexname: tidymodels-penguins07\nextype: schoice\nexsolution: r fmt(sol)\nexshuffle: no\nexpoints: 1\ncategories:\n- tidymodels\n- statlearning\n- trees\n- schoice\ndate: '2023-05-17'\nslug: tidymodels-penguins07\ntitle: tidymodels-penguins07\n\n---\n\n\n\n\n\n\n\n\n\n# Aufgabe\n\nBerechnen Sie ein Entscheidungsbaum-Modell mit tidymodels und zwar anhand des penguins Datensatzes.\n\nModellgleichung: `body_mass_g ~ bill_length_mm`.\n\nBerichten Sie die RMSE!\n\n\n\nHinweise:\n\n- Tuning Sie $Cp$ mit 20 verschiedenen den Werten.\n- Löschen Sie alle Zeilen mit fehlenden Werten in den Prädiktoren.\n- Beachten Sie die [üblichen Hinweise](https://datenwerk.netlify.app/hinweise).\n- Natürlich gilt: Ceteris paribus. Halten Sie also die Modelle im Übrigen vergleichbar bzw. identisch.\n\n\n\n\n\n\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n\n# Lösung\n\n## Setup\n\n\n::: {.cell hash='tidymodels-penguins07_cache/html/unnamed-chunk-1_542fc224c9d74967494c470223767144'}\n\n```{.r .cell-code}\nlibrary(tidymodels)\nlibrary(tidyverse)\nlibrary(tictoc)  # Rechenzeit messen, optional\n# data(penguins, package = \"palmerpenguins\")\nd_path <- \"https://vincentarelbundock.github.io/Rdatasets/csv/modeldata/penguins.csv\"\nd <- read_csv(d_path)\n```\n:::\n\n\n\nWir dürfen keine fehlenden Werte in der Y-Variable haben (im Train-Set),\nsonst meckert Tidymodels:\n\n\n\n::: {.cell hash='tidymodels-penguins07_cache/html/unnamed-chunk-2_ac23e6ca33fe8a7291ac8db451a0213d'}\n\n```{.r .cell-code}\nd2 <- \n  d %>% \n  drop_na(body_mass_g)\n```\n:::\n\n\n# CV\n\n## Daten aufteilen:\n\n\n::: {.cell hash='tidymodels-penguins07_cache/html/unnamed-chunk-3_755dd1cf32aba6c795ded8c777ee7f18'}\n\n```{.r .cell-code}\nset.seed(42)\nd_split <- initial_split(d2)\nd_train <- training(d_split)\nd_test <- testing(d_split)\n```\n:::\n\n\n\n\n## CV\n\n\n::: {.cell hash='tidymodels-penguins07_cache/html/unnamed-chunk-4_78cebf2e996018d6e6c95ce647050a04'}\n\n```{.r .cell-code}\nset.seed(42)\nfolds <- vfold_cv(d_train, v = 10)\n```\n:::\n\n\n\n\n\n## Workflow\n\n\n\n\n::: {.cell hash='tidymodels-penguins07_cache/html/unnamed-chunk-5_9da0ee4214fb1e6b71a7a7581b11bc48'}\n\n```{.r .cell-code}\nrec1 <-\n  recipe(body_mass_g ~ bill_length_mm, data = d_train) %>% \n  step_naomit(all_numeric_predictors())\n\nmod_tree <- \ndecision_tree(\n  mode = \"regression\",\n  cost_complexity = tune()\n)\n\nwflow <-\n  workflow() %>%\n  add_recipe(rec1) %>%\n  add_model(mod_tree)\n```\n:::\n\n\n\n\n\n## Fitten\n\n\n::: {.cell hash='tidymodels-penguins07_cache/html/unnamed-chunk-6_4846e4bd6ce408b8ec2e61fe21116fb3'}\n\n```{.r .cell-code}\ntic()\nwflow_fit <-\n  tune_grid(\n    wflow,\n    resamples = folds,\n    control = control_grid(save_workflow = TRUE),\n    grid = 20,\n    metrics = metric_set(rmse)\n    )\ntoc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n15.438 sec elapsed\n```\n:::\n:::\n\n\n\n\n\n## Modellgüte\n\n\n\n::: {.cell hash='tidymodels-penguins07_cache/html/unnamed-chunk-7_2ec04cc0712499bbf66c9fee25f0612f'}\n\n```{.r .cell-code}\nbestfit1 <- fit_best(x = wflow_fit)\nlastfit1 <- last_fit(bestfit1, d_split)\ncollect_metrics(lastfit1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 4\n  .metric .estimator .estimate .config             \n  <chr>   <chr>          <dbl> <chr>               \n1 rmse    standard     638.    Preprocessor1_Model1\n2 rsq     standard       0.315 Preprocessor1_Model1\n```\n:::\n:::\n\n\n\n\n\n\n---\n\nCategories: \n\n- tidymodels\n- statlearning\n- trees\n- schoice\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}