{
  "hash": "4e68e9a428e4ad2d63db347ad28ec251",
  "result": {
    "engine": "knitr",
    "markdown": "---\nextype: string\nexsolution: NA\nexname: iq-studentis\nexpoints: 1\ncategories:\n- probability\n- bayes\n- simulation\n- qm2-pruefung2023\ndate: '2022-11-05'\ntitle: iq-studentis\n\n---\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n# Exercise\n\n*Intelligenz von Studentis*\n\nEine Psychologin möchte die Intelligenz von Studentis bestimmen: \nWas ist wohl der Mittelwert? Wie schlau sind die schlausten 10%? \nVon wo bis wo geht das mittlere 90%-Intervall von IQ-Werten? \nNatürlich ist ihr klar, dass es nicht reicht, einen Mittelwert zu schätzen. \nNein, sie will alles, sprich: die Posteriori-Verteilung.\n\n\nZuerst überlegt sie sich die Prioris: \n\"Was ist meine Einschätzung zur Intelligenz von Studentis?\". \nDazu liest sie alle verfügbare Literatur, beurteilt die methodische Qualität jeder einzelnen Studie und spricht mit den Expertis. \nAuf dieser Basis kommt sie zu folgenden Prioris:\n\n\n$$\\mu \\sim \\mathcal{N}(115, 5)$$\nEin paar Überlegungen, die unsere Psychologin dazu hatte: \nDie Studentis sind im Mittel schlauer als die Normalbevölkerung. \nUm ein Gefühl für die Verteilungsfunktion vom IQ zu bekommen, nutzt sie folgenden R-Befehl:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npnorm(q = 115, mean = 100, sd = 15)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.8413447\n```\n\n\n:::\n:::\n\nDieser Befehl gibt ihr an, \nwelcher Prozentsatz der allgemeinen Bevölkerung (die Wahrscheinlichkeitsmasse) nicht schlauer ist als 115. \n\nDann versucht sie ein Gefühl für die Streuung ($\\sigma$) zu bekommen, \nfolgender R-Befehl hilft ihr:\n\n::: {.cell}\n\n```{.r .cell-code}\nq_iq <- 50\nrate_lambda <- 0.1\npexp(q = q_iq, rate = rate_lambda)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.9932621\n```\n\n\n:::\n:::\n\n\nAh! Nimmt man an, dass Sigma exponentialverteilt ist mit einer Rate von 0.1, \ndass sind etwa  99 Prozent der Leute nicht mehr als `q_iq` IQ-Punkte vom Mittelwert $\\mu$ entfernt. \nDas deckt sich mit ihren Informationen aus der Literatur.\n\nDamit sind die Priors spezifiziert.\n\n*Augaben*:\n\na) Geben Sie die Priors an.\nb) Simulieren Sie die Prior-Prädiktiv-Verteilung dazu.\nc) Befragen Sie die Prior-Prädiktiv-Verteilung mit geeigneten Fragen Ihrer Wahl.\n\n\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n\n[Hinweise](https://start-bayes.netlify.app/pruefung#bearbeitungshinweise)\n\n\n# Solution\n\n\na) Geben Sie die Priors an.\n\n$$\\mu \\sim \\mathcal{N}(115, 5)$$\n\n$$\\sigma \\sim \\mathcal{E}(0.1)$$\n\n\n\nb) Simulieren Sie die Prior-Prädiktiv-Verteilung dazu.\n\n\nZiehen wir Zufallszahlen entsprechend der Priori-Werte:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nn <- 1e4\n\nsim <-\n  tibble(\n    sample_mu = rnorm(n,\n      mean = 115,\n      sd   = 10\n    ),\n    sample_sigma = rexp(n,\n      rate = 0.1\n    ),\n    iq = rnorm(n,\n      mean = sample_mu,\n      sd   = sample_sigma\n    )\n  )\n```\n:::\n\n\nWas ist wohl der Mittelwert und die SD dieser Priori-Prädiktiv-Verteilung?\n\n::: {.cell}\n\n```{.r .cell-code}\nheight_sim_sd <-\n  sd(sim$iq) %>% round()\nheight_sim_sd\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 17\n```\n\n\n:::\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheight_sim_mean <-\n  mean(sim$iq) %>% round()\nheight_sim_mean\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 115\n```\n\n\n:::\n:::\n\n\nUnd jetzt plotten wir diese Verteilung:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsim %>%\n  ggplot() +\n  aes(x = iq) +\n  geom_histogram() +\n  geom_point(\n    y = 0, x = height_sim_mean, size = 5,\n    color = \"blue\", alpha = .5\n  ) +\n  geom_vline(\n    xintercept = c(\n      height_sim_mean + height_sim_sd,\n      height_sim_mean - height_sim_sd\n    ),\n    linetype = \"dotted\"\n  ) +\n  labs(caption = \"Der blaue Punkt zeigt den Mittelwert; die gepunkteten Linien MD±SD\") +\n  scale_x_continuous(\n    limits = c(70, 145),\n    breaks = seq(70, 145, by = 5)\n  )\n```\n\n::: {.cell-output-display}\n![](iq-studentis_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nOder vielleicht besser als Dichte-Diagramm, das zeigt das \"Big Picture\" vielleicht besser:\n\n::: {.cell}\n\n```{.r .cell-code}\nsim %>%\n  ggplot() +\n  aes(x = iq) +\n  geom_density()\n```\n\n::: {.cell-output-display}\n![](iq-studentis_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nHm, etwas randlastig die Verteilung.\n\n\nZoomen wir etwas mehr rein:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsim %>%\n  ggplot() +\n  aes(x = iq) +\n  geom_density() +\n  scale_x_continuous(limits = c(65, 165))\n```\n\n::: {.cell-output-display}\n![](iq-studentis_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n\nc) Befragen Sie die Prior-Prädiktiv-Verteilung mit geeigneten Fragen Ihrer Wahl.\n\n\nWas ist der Mittelwert und die SD und die üblichen deskriptiven Kennwerte?\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(easystats)\n```\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsim %>%\n  select(iq) %>%\n  describe_distribution()\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|Variable |     Mean|       SD|      IQR|      Min|      Max|  Skewness| Kurtosis|     n| n_Missing|\n|:--------|--------:|--------:|--------:|--------:|--------:|---------:|--------:|-----:|---------:|\n|iq       | 114.9435| 17.04762| 17.85691| 9.422287| 314.2702| 0.2625464| 6.304434| 10000|         0|\n\n</div>\n:::\n:::\n\nIn welchem Bereich liegen die mittleren 95% der IQ-Werte?\n\n::: {.cell}\n\n```{.r .cell-code}\nsim %>%\n  eti()\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|Parameter    |   CI|    CI_low|   CI_high|\n|:------------|----:|---------:|---------:|\n|sample_mu    | 0.95| 95.149648| 134.28994|\n|sample_sigma | 0.95|  0.253327|  36.54489|\n|iq           | 0.95| 81.525775| 149.68331|\n\n</div>\n:::\n:::\n\n\nAlternativ könnten wir in z-transformierten Daten denken:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsim2 <-\n  tibble(\n    sample_mu =\n      rnorm(n,\n        mean = 0,\n        sd   = 1\n      ),\n    sample_sigma =\n      rexp(n,\n        rate = 1\n      )\n  ) %>%\n  mutate(\n    iq =\n      rnorm(n,\n        mean = sample_mu,\n        sd   = sample_sigma\n      )\n  )\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsim2 %>%\n  ggplot() +\n  aes(x = iq) +\n  geom_density()\n```\n\n::: {.cell-output-display}\n![](iq-studentis_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\nMann kann auch `ggpubr` zum Visualisieren nutzen, anstelle von `ggplot2`:\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggpubr)\nggdensity(sim2, x = \"iq\")\n```\n\n::: {.cell-output-display}\n![](iq-studentis_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n---\n\nCategories: \n\n- probability\n- bayes\n- simulation\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}