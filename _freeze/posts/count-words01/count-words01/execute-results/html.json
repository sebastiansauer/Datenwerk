{
  "hash": "182737dfc37f50d728976c83f5aed7a2",
  "result": {
    "engine": "knitr",
    "markdown": "---\nexname: count-words01\nexpoints: 1\nextype: string\nexsolution: NA\ncategories:\n- textmining\n- tidymodels\n- count\n- germeval\n- string\ndate: '2023-11-15'\nslug: count-words01\ntitle: count-words01\n\n---\n\n\n\n\n\n\n# Aufgabe\n\nZählen sie die Wörter eines Textes. Verwenden Sie verschiedene Verfahren.\nUntersuchen Sie die Rechenzeit, die die jeweiligen Verfahren benötigen.\n\nNutzen Sie die [GermEval-2018-Daten](https://heidata.uni-heidelberg.de/dataset.xhtml?persistentId=doi:10.11588/data/0B5VML).\nDie Daten sind unter CC-BY-4.0 lizensiert. Author: Wiegand, Michael (Spoken Language Systems, Saarland University (2010-2018), Leibniz Institute for the German Language (since 2019)),\nDie Daten sind auch über das R-Paket [PradaData](https://github.com/sebastiansauer/pradadata/tree/master/data-raw/GermEval-2018-Data-master) zu beziehen.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nd_train <- read_csv(\"https://raw.githubusercontent.com/sebastiansauer/pradadata/master/data-raw/germeval_train.csv\")\nd_test <- read_csv(\"https://raw.githubusercontent.com/sebastiansauer/pradadata/master/data-raw/germeval_test.csv\")\n```\n:::\n\n\n\nHinweise:\n\n- Orientieren Sie sich im Übrigen an den [allgemeinen Hinweisen des Datenwerks](https://datenwerk.netlify.app/hinweise).\n\n\n\n\n\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n\n# Lösung\n\n\n\n# Setup\n\n\n::: {.cell}\n\n```{.r .cell-code}\noptions(paged.print = FALSE,\n        pillar.print_max = 15, \n        pillar.print_min = 10)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tictoc)\n#library(tokenizers)\n#library(qdap)\n```\n:::\n\n\n\nTeststring:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntest_text <-\n  tibble(id = 1:4,\n         text = c(\"Abbau ist jetzt\", \"Test heute\", \"Abbruch morgen\", \"Abmachung lore ipsum\"),\n         valence = c(-1, 0, -1, +1))\n\ntest_text\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 3\n     id text                 valence\n  <int> <chr>                  <dbl>\n1     1 Abbau ist jetzt           -1\n2     2 Test heute                 0\n3     3 Abbruch morgen            -1\n4     4 Abmachung lore ipsum       1\n```\n\n\n:::\n:::\n\n\n\nDaten importieren:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(germeval_train, package = \"pradadata\")\n```\n:::\n\n\n\n\n# Wörter zählen im Test-Datensatz\n\n\n\n## `stringr::str_count`\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntest_text$text |> \n  map_int(str_count, \"\\\\w+\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3 2 2 3\n```\n\n\n:::\n:::\n\n\nOder so:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntest_text$text |> \n  map_int(str_count, boundary(\"word\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3 2 2 3\n```\n\n\n:::\n:::\n\n\n\nDie Funktion `map` ist nicht nötig:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstr_count(test_text$text, boundary(\"word\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3 2 2 3\n```\n\n\n:::\n:::\n\n\n\nAls neue Spalte in der Tabelle:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntest_text |> \n  mutate(n_words = str_count(text, boundary(\"word\")))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 4\n     id text                 valence n_words\n  <int> <chr>                  <dbl>   <int>\n1     1 Abbau ist jetzt           -1       3\n2     2 Test heute                 0       2\n3     3 Abbruch morgen            -1       2\n4     4 Abmachung lore ipsum       1       3\n```\n\n\n:::\n:::\n\n\n\n\n\n## `tokenizers::count_words`\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntokenizers::count_words(test_text$text)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3 2 2 3\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntest_text |> \n  mutate(n_words = tokenizers::count_words(text))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 4\n     id text                 valence n_words\n  <int> <chr>                  <dbl>   <int>\n1     1 Abbau ist jetzt           -1       3\n2     2 Test heute                 0       2\n3     3 Abbruch morgen            -1       2\n4     4 Abmachung lore ipsum       1       3\n```\n\n\n:::\n:::\n\n\n\n\n## `qdap:wc`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqdap::wc(test_text$text)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3 2 2 3\n```\n\n\n:::\n:::\n\n\n\n\n# Germeval-Datensatz\n\n\n\n\n\n## `stringr::str_count`\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntic()\nmethod1 <- germeval_train$text |> \n  map_int(str_count, \"\\\\w+\")\ntoc()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n0.185 sec elapsed\n```\n\n\n:::\n\n```{.r .cell-code}\nmethod1 |> str()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n int [1:5009] 15 19 11 21 15 44 34 8 13 14 ...\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(method1, max = 20)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] 15 19 11 21 15 44 34  8 13 14 14 28 39 22 43 28 19 23 25 13\n [ reached getOption(\"max.print\") -- omitted 4989 entries ]\n```\n\n\n:::\n:::\n\n\n\nOder so:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntic()\nmethod2 <- germeval_train$text |> \n  map_int(str_count, boundary(\"word\"))\ntoc()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n0.158 sec elapsed\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(method2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 15 19 10 21 15 44\n```\n\n\n:::\n:::\n\n\n\nDie Funktion `map` ist nicht nötig:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntic()\nmethod3 <- str_count(germeval_train$text, boundary(\"word\"))\ntoc()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n0.028 sec elapsed\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmethod3 |> head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 15 19 10 21 15 44\n```\n\n\n:::\n:::\n\n\n\n\nDann geht es auch viel schneller.\n\nAls neue Spalte in der Tabelle:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntic()\nmethod4 <- \ngermeval_train |> \n  mutate(n_words = str_count(text, boundary(\"word\")))\ntoc()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n0.026 sec elapsed\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(method4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n'data.frame':\t5009 obs. of  5 variables:\n $ id     : int  1 2 3 4 5 6 7 8 9 10 ...\n $ text   : chr  \"@corinnamilborn Liebe Corinna, wir würden dich gerne als Moderatorin für uns gewinnen! Wärst du begeisterbar?\" \"@Martin28a Sie haben ja auch Recht. Unser Tweet war etwas missverständlich. Dass das BVerfG Sachleistungen nich\"| __truncated__ \"@ahrens_theo fröhlicher gruß aus der schönsten stadt der welt theo ⚓️\" \"@dushanwegner Amis hätten alles und jeden gewählt...nur Hillary wollten sie nicht und eine Fortsetzung von Obam\"| __truncated__ ...\n $ c1     : chr  \"OTHER\" \"OTHER\" \"OTHER\" \"OTHER\" ...\n $ c2     : chr  \"OTHER\" \"OTHER\" \"OTHER\" \"OTHER\" ...\n $ n_words: int  15 19 10 21 15 44 34 8 13 14 ...\n - attr(*, \".internal.selfref\")=<externalptr> \n```\n\n\n:::\n\n```{.r .cell-code}\nmethod4 |> head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  id\n1  1\n2  2\n3  3\n4  4\n5  5\n6  6\n                                                                                                                                                                                                                                                                                          text\n1                                                                                                                                                                                @corinnamilborn Liebe Corinna, wir würden dich gerne als Moderatorin für uns gewinnen! Wärst du begeisterbar?\n2                                                                                                                                               @Martin28a Sie haben ja auch Recht. Unser Tweet war etwas missverständlich. Dass das BVerfG Sachleistungen nicht ausschließt, kritisieren wir.\n3                                                                                                                                                                                                                        @ahrens_theo fröhlicher gruß aus der schönsten stadt der welt theo ⚓️\n4                                                                                                                                                 @dushanwegner Amis hätten alles und jeden gewählt...nur Hillary wollten sie nicht und eine Fortsetzung von Obama-Politik erst recht nicht..!\n5                                                                                                                                                     @spdde kein verläßlicher Verhandlungspartner. Nachkarteln nach den Sondierzngsgesprächen - schickt diese Stümper #SPD in die Versenkung.\n6 @Dirki_M Ja, aber wo widersprechen die Zahlen denn denen, die im von uns verlinkten Artikel stehen? In unserem Tweet geht es rein um subs. Geschützte. 2017 ist der gesamte Familiennachzug im Vergleich zu 2016 - die Zahlen, die Hr. Brandner bemüht - übrigens leicht rückläufig gewesen.\n       c1     c2 n_words\n1   OTHER  OTHER      15\n2   OTHER  OTHER      19\n3   OTHER  OTHER      10\n4   OTHER  OTHER      21\n5 OFFENSE INSULT      15\n6   OTHER  OTHER      44\n```\n\n\n:::\n:::\n\n\n\n## `tokenizers::count_words`\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntic()\nmethod5 <- tokenizers::count_words(germeval_train$text)\ntoc()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n0.025 sec elapsed\n```\n\n\n:::\n\n```{.r .cell-code}\nhead(method5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 15 19 10 21 15 44\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntic()\nmethod6 <-\ngermeval_train |> \n  mutate(n_words = tokenizers::count_words(text))\ntoc()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n0.026 sec elapsed\n```\n\n\n:::\n\n```{.r .cell-code}\nmethod6 |> head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  id\n1  1\n2  2\n3  3\n4  4\n5  5\n6  6\n                                                                                                                                                                                                                                                                                          text\n1                                                                                                                                                                                @corinnamilborn Liebe Corinna, wir würden dich gerne als Moderatorin für uns gewinnen! Wärst du begeisterbar?\n2                                                                                                                                               @Martin28a Sie haben ja auch Recht. Unser Tweet war etwas missverständlich. Dass das BVerfG Sachleistungen nicht ausschließt, kritisieren wir.\n3                                                                                                                                                                                                                        @ahrens_theo fröhlicher gruß aus der schönsten stadt der welt theo ⚓️\n4                                                                                                                                                 @dushanwegner Amis hätten alles und jeden gewählt...nur Hillary wollten sie nicht und eine Fortsetzung von Obama-Politik erst recht nicht..!\n5                                                                                                                                                     @spdde kein verläßlicher Verhandlungspartner. Nachkarteln nach den Sondierzngsgesprächen - schickt diese Stümper #SPD in die Versenkung.\n6 @Dirki_M Ja, aber wo widersprechen die Zahlen denn denen, die im von uns verlinkten Artikel stehen? In unserem Tweet geht es rein um subs. Geschützte. 2017 ist der gesamte Familiennachzug im Vergleich zu 2016 - die Zahlen, die Hr. Brandner bemüht - übrigens leicht rückläufig gewesen.\n       c1     c2 n_words\n1   OTHER  OTHER      15\n2   OTHER  OTHER      19\n3   OTHER  OTHER      10\n4   OTHER  OTHER      21\n5 OFFENSE INSULT      15\n6   OTHER  OTHER      44\n```\n\n\n:::\n:::\n\n\n\n\n## `qdap::wc`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntic()\nmethod7 <- qdap::wc(germeval_train$text)\ntoc()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n1.243 sec elapsed\n```\n\n\n:::\n\n```{.r .cell-code}\nmethod7 |> head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 15 20 10 19 15 42\n```\n\n\n:::\n:::\n\n\nDeutlich langsamer als mit `tokenizers`.\n\n\n\n\n---\n\nCategories: \n\n- textmining\n- tidymodels\n- count\n- germeval\n- string\n\n",
    "supporting": [
      "count-words01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}