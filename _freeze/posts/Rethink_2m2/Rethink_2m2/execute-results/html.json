{
  "hash": "804a714584ce51cc7d3a5673cdd9ae77",
  "result": {
    "markdown": "---\nextype: string\nexsolution: NA\nexname: rethink2m1\nexpoints: 1\ncategories:\n- probability\n- bayes-grid\ndate: '2022-10-27'\nslug: Rethink_2m2\ntitle: Rethink_2m2\n\n---\n\n\n\n\n\n\n\n\n\n\n\n\n\n# Exercise\n\nThis question is taken from McElreath, R. (2020). *Statistical rethinking: A Bayesian course with examples in R and Stan* (2. Ed.). Taylor and Francis, CRC Press.\n\n\nRecall the globe tossing model from the chapter. Compute and plot the grid approximate posterior distribution for each of the following sets of observations. In each case, assume a uniform prior for *p*.\n\nData: \n\n1. WWW\n2. WWWL\n3. LWWLWWW\n\n\nNow assume a prior for p that is equal to zero when p < 0.5 and is a positive constant when p ≥ 0.5. Again compute and plot the grid approximate posterior distribution for each of the sets of observations in the problem just above.\n\n\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n\n# Solution\n\nThe solution is taken from [this source](https://sr2-solutions.wjakethompson.com/bayesian-inference.html).\n\n\n\n::: {.cell hash='Rethink_2m2_cache/html/unnamed-chunk-1_f1e6678c15b3f5771a7d3b3c9b8431e9'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\ndist <- \n  tibble(\n    # Gridwerte bestimmen:\n    p_grid = seq(from = 0, to = 1, length.out = 20),\n    # Priori-Wskt bestimmen:\n    prior  = case_when(\n      p_grid < 0.5 ~ 0,\n      p_grid >= 0.5 ~ 1)) %>%\n  mutate(\n    # Likelihood berechnen:\n    likelihood_1 = dbinom(3, size = 3, prob = p_grid),\n    likelihood_2 = dbinom(3, size = 4, prob = p_grid),\n    likelihood_3 = dbinom(5, size = 7, prob = p_grid),\n    # unstand. Posterior-Wskt:\n    unstand_post_1 = likelihood_1 * prior,\n    unstand_post_2 = likelihood_2 * prior,\n    unstand_post_3 = likelihood_3 * prior,\n    # stand. Post-Wskt:\n    std_post_1 = unstand_post_1 / sum(unstand_post_1),\n    std_post_2 = unstand_post_2 / sum(unstand_post_1),\n    std_post_3 = unstand_post_3 / sum(unstand_post_1)\n    ) \n```\n:::\n\n\nJetzt können wir das Diagramm zeichnen:\n\n\n::: {.cell hash='Rethink_2m2_cache/html/unnamed-chunk-2_96e764b8973dc24db82fa7ff51982cff'}\n\n```{.r .cell-code}\nggplot(dist) +\n  aes(x = p_grid, y= std_post_1) +\n  geom_line()+\n  geom_point() +\n  labs(x = \"p(W)\",\n       y = \"Posteriori-Wahrscheinlichkeit\",\n       title = \"Daten: WWW\")\n```\n\n::: {.cell-output-display}\n![](unnamed-chunk-2-1.png){fig-pos='H' width=384}\n:::\n:::\n\n::: {.cell hash='Rethink_2m2_cache/html/unnamed-chunk-3_49456527856f7c034fd836cecbd09b0c'}\n\n```{.r .cell-code}\nggplot(dist) +\n  aes(x = p_grid, y= std_post_2) +\n  geom_line()+\n  geom_point() +\n  labs(x = \"p(W)\",\n       y = \"Posteriori-Wahrscheinlichkeit\",\n       title = \"Daten: WWWL\")\n```\n\n::: {.cell-output-display}\n![](unnamed-chunk-3-1.png){fig-pos='H' width=384}\n:::\n:::\n\n::: {.cell hash='Rethink_2m2_cache/html/unnamed-chunk-4_ab6494d98e7b4c9368bad7b2ed63576c'}\n\n```{.r .cell-code}\nggplot(dist) +\n  aes(x = p_grid, y= std_post_3) +\n  geom_line()+\n  geom_point() +\n  labs(x = \"p(W)\",\n       y = \"Posteriori-Wahrscheinlichkeit\",\n       title = \"Daten: LWWLWWW\")\n```\n\n::: {.cell-output-display}\n![](unnamed-chunk-4-1.png){fig-pos='H' width=384}\n:::\n:::\n\n\n\nEtwas eleganter (und deutlich komplizierter) kann man es auch so in R schreiben ([Quelle](https://sr2-solutions.wjakethompson.com/bayesian-inference.html)):\n\n\n::: {.cell hash='Rethink_2m2_cache/html/unnamed-chunk-5_12e41ee2931a28490ec923de04e2efed'}\n\n```{.r .cell-code}\ndist <- tibble(p_grid = seq(from = 0, to = 1, length.out = 20)) %>%\n  mutate(prior = case_when(\n    p_grid < 0.5 ~ 0L,\n    TRUE ~ 1L),\n    likelihood_1 = dbinom(3, size = 3, prob = p_grid),\n    likelihood_2 = dbinom(3, size = 4, prob = p_grid),\n    likelihood_3 = dbinom(5, size = 7, prob = p_grid),\n    across(starts_with(\"likelihood\"), ~ .x * prior),\n    across(starts_with(\"likelihood\"), ~ .x / sum(.x))) %>%\n  pivot_longer(cols = starts_with(\"likelihood\"), names_to = \"pattern\",\n               values_to = \"posterior\") %>%\n  separate(pattern, c(NA, \"pattern\"), sep = \"_\", convert = TRUE) %>%\n  mutate(obs = case_when(pattern == 1L ~ \"W, W, W\",\n                         pattern == 2L ~ \"W, W, W, L\",\n                         pattern == 3L ~ \"L, W, W, L, W, W, W\"))\n\nggplot(dist, aes(x = p_grid, y = posterior)) +\n  facet_wrap(vars(fct_inorder(obs)), nrow = 1) +\n  geom_line() +\n  geom_point() +\n  labs(x = \"Proportion Water (p)\", y = \"Posterior Density\")\n```\n\n::: {.cell-output-display}\n![](unnamed-chunk-5-1.png){fig-pos='H' width=384}\n:::\n:::\n\n\n\n\n---\n\nCategories: \n\n- probability\n- bayes-grid\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}