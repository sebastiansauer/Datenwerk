{
  "hash": "6582548407c5a39b9a4d3e824276b414",
  "result": {
    "engine": "knitr",
    "markdown": "---\nextype: string\nexsolution: NA\nexname: purrr-map04\nexpoints: 1\ncategories:\n- R\n- map\n- tidyverse\ndate: '2022-10-24'\nslug: purrr-map04\ntitle: purrr-map04\n\n---\n\n\n\n\n\n# Exercise\n\nImportieren Sie das Grundatzprogramm der Partei AfD (in der aktuellsten Version). \nTokenisieren Sie nach Seiten. \nDann verschachteln Sie die Spalte, in denen der Text der Seite steht, zu einer Listenspalte.\nSchließlich zählen Sie die Anzahl der Wörter pro Seite und berichten gängige deskriptive Statistiken dazu.\n\n\n\n\n\n\n\n\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n\n# Solution\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.3     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.0\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n:::\n\n\nText aus PDF-Dateien kann man mit dem Paket [`pdftools`](https://docs.ropensci.org/pdftools/) einlesen:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(pdftools)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nUsing poppler version 22.02.0\n```\n\n\n:::\n\n```{.r .cell-code}\nd_path <- \"~/Literatur/_Div/Politik/afd-grundsatzprogramm-2022.pdf\"\n\nd <- tibble(text = pdf_text(d_path))\n```\n:::\n\n\n\n\n\nZu Seiten tokenisieren brauchen wir nicht; das Datenmaterial ist bereits nach Seiten organisiert.\n\nJetzt \"verschachteln\" (to nest) wir die Spalte mit dem Text:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd2 <-\n  d %>% \n  nest(data = text)\n\nhead(d2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 1\n  data             \n  <list>           \n1 <tibble [96 × 1]>\n```\n\n\n:::\n:::\n\n\n\n\nDann zählen wir die Wörter pro Seite:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd3 <-\n  d2 %>% \n  mutate(word_count_per_page = map(data, ~ str_count(.x$text, \"\\\\w+\")))\n\nhead(d3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 2\n  data              word_count_per_page\n  <list>            <list>             \n1 <tibble [96 × 1]> <int [96]>         \n```\n\n\n:::\n:::\n\nWie sieht eine Zelle aus `data` aus?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd3$data[[1]]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 96 × 1\n   text                                                                         \n   <chr>                                                                        \n 1 \"PROGRAMM FÜR\\nDEUTSCHLAND.\\nDas Grundsatzprogramm der Alternative für Deuts…\n 2 \"2   Programm für Deutschland | Inhalt\\n\\n\\n\\n\\n    Präambel\\t\\t\\t\\t\\t\\t    …\n 3 \"3   Programm für Deutschland | Inhalt\\n\\n\\n\\n\\n    7 | Kultur, Sprache und …\n 4 \"4   Programm für Deutschland | Inhalt\\n\\n\\n\\n\\n    11 | Finanzen und Steuer…\n 5 \"Präambel.\\n\"                                                                \n 6 \"6   Programm für Deutschland | Präambel\\n\\n\\n\\n\\n    MUT ZU DEUTSCHLAND.   …\n 7 \"KAPITEL 1\\n\\n\\n\\n\\nDemokratie und\\nGrundwerte\\n\"                            \n 8 \"8   Programm für Deutschland | Demokratie und Grundwerte\\n\\n\\n\\n\\n    DEMOK…\n 9 \"9   Programm für Deutschland | Demokratie und Grundwerte\\n\\n\\n\\n\\n    1.1 V…\n10 \"10   Programm für Deutschland | Demokratie und Grundwerte\\n\\n\\n\\n\\n     ble…\n# ℹ 86 more rows\n```\n\n\n:::\n:::\n\n\nWie sieht eine Zelle aus `word_count_per_page` aus?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd3$data[[1]]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 96 × 1\n   text                                                                         \n   <chr>                                                                        \n 1 \"PROGRAMM FÜR\\nDEUTSCHLAND.\\nDas Grundsatzprogramm der Alternative für Deuts…\n 2 \"2   Programm für Deutschland | Inhalt\\n\\n\\n\\n\\n    Präambel\\t\\t\\t\\t\\t\\t    …\n 3 \"3   Programm für Deutschland | Inhalt\\n\\n\\n\\n\\n    7 | Kultur, Sprache und …\n 4 \"4   Programm für Deutschland | Inhalt\\n\\n\\n\\n\\n    11 | Finanzen und Steuer…\n 5 \"Präambel.\\n\"                                                                \n 6 \"6   Programm für Deutschland | Präambel\\n\\n\\n\\n\\n    MUT ZU DEUTSCHLAND.   …\n 7 \"KAPITEL 1\\n\\n\\n\\n\\nDemokratie und\\nGrundwerte\\n\"                            \n 8 \"8   Programm für Deutschland | Demokratie und Grundwerte\\n\\n\\n\\n\\n    DEMOK…\n 9 \"9   Programm für Deutschland | Demokratie und Grundwerte\\n\\n\\n\\n\\n    1.1 V…\n10 \"10   Programm für Deutschland | Demokratie und Grundwerte\\n\\n\\n\\n\\n     ble…\n# ℹ 86 more rows\n```\n\n\n:::\n:::\n\n\nAh! Darin steckt nur eine einzelne Zahl!\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd3$data[[1]] %>% str()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntibble [96 × 1] (S3: tbl_df/tbl/data.frame)\n $ text: chr [1:96] \"PROGRAMM FÜR\\nDEUTSCHLAND.\\nDas Grundsatzprogramm der Alternative für Deutschland.\\n\" \"2   Programm für Deutschland | Inhalt\\n\\n\\n\\n\\n    Präambel\\t\\t\\t\\t\\t\\t                                        \"| __truncated__ \"3   Programm für Deutschland | Inhalt\\n\\n\\n\\n\\n    7 | Kultur, Sprache und Identität\\t\\t\\t\\t                   \"| __truncated__ \"4   Programm für Deutschland | Inhalt\\n\\n\\n\\n\\n    11 | Finanzen und Steuern\\t\\t\\t\\t\\t                         \"| __truncated__ ...\n```\n\n\n:::\n:::\n\n\n\nDas heißt, wir können vereinfachen, entschacheln:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd4 <-\n  d3 %>% \n  unnest(word_count_per_page)\n\nhead(d4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 2\n  data              word_count_per_page\n  <list>                          <int>\n1 <tibble [96 × 1]>                   9\n2 <tibble [96 × 1]>                 410\n3 <tibble [96 × 1]>                 516\n4 <tibble [96 × 1]>                 297\n5 <tibble [96 × 1]>                   1\n6 <tibble [96 × 1]>                 414\n```\n\n\n:::\n:::\n\n\nVisualisierung:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd4 %>% \n  ggplot(aes(x = word_count_per_page)) +\n  geom_histogram()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](purrr-map04_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(easystats)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n# Attaching packages: easystats 0.6.0 (red = needs update)\n✔ bayestestR  0.13.1   ✔ correlation 0.8.4 \n✔ datawizard  0.9.0    ✔ effectsize  0.8.6 \n✔ insight     0.19.6   ✔ modelbased  0.8.6 \n✔ performance 0.10.8   ✔ parameters  0.21.3\n✔ report      0.5.7    ✖ see         0.8.0 \n\nRestart the R-Session and update packages in red with `easystats::easystats_update()`.\n```\n\n\n:::\n\n```{.r .cell-code}\ndescribe_distribution(d4$word_count_per_page)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Mean |     SD |    IQR |          Range | Skewness | Kurtosis |  n | n_Missing\n--------------------------------------------------------------------------------\n285.84 | 172.27 | 322.75 | [1.00, 516.00] |    -0.64 |    -1.24 | 96 |         0\n```\n\n\n:::\n:::\n\n\n\n\n\n\n---\n\nCategories: \n\n- R\n- map\n- tidyverse\n\n",
    "supporting": [
      "purrr-map04_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}