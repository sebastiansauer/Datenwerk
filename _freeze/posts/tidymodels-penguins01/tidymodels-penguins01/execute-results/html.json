{
  "hash": "e92c7481cb5bfcfaf038934983aba8a4",
  "result": {
    "markdown": "---\nexname: tidymodels-penguins01\nextype: num\nexsolution: r fmt(sol)\nexshuffle: no\nextol: 1\nexpoints: 1\ncategories:\n- ds1\n- tidymodels\n- prediction\n- yacsda\n- statlearning\n- num\ndate: '2023-05-17'\nslug: tidymodels-penguins01\ntitle: tidymodels-penguins01\n\n---\n\n\n\n\n\n\n\n\n\n# Aufgabe\n\nBerechnen Sie ein lineares Modell mit tidymodels und zwar anhand des `penguins` Datensatzes.\n\n\nModellgleichung: `body_mass_g ~ bill_length_mm, data = d_train`.\n\n\n\nGesucht ist R-Quadrat als Maß für die Modellgüte im *TEST-Sample*.\n\n\n\n*Hinweise*:\n\n- Fixieren Sie die Zufallszahlen auf den Startwert 42.\n- Nutzen Sie eine v=5,r=1 CV.\n- Entfernen Sie fehlende Werte in den Variablen.\n- Verzichten Sie auf weitere Schritte der Vorverarbeitung.\n\n\n\n\n\n\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n\n# Lösung\n\nSetup:\n\n\n::: {.cell hash='tidymodels-penguins01_cache/html/unnamed-chunk-1_f0f0977ded0f10267a18119aedad9498'}\n\n```{.r .cell-code}\nlibrary(tidymodels)\nlibrary(tictoc)  # Rechenzeit messen, optional\n# data(penguins, package = \"palmerpenguins\")\nd_path <- \"https://vincentarelbundock.github.io/Rdatasets/csv/modeldata/penguins.csv\"\nd <- read.csv(d_path)\n```\n:::\n\n\n\n\nDatensatz aufteilen:\n\n\n\n::: {.cell hash='tidymodels-penguins01_cache/html/unnamed-chunk-2_8caa24424569495fbba4dfc0f80b3a1a'}\n\n```{.r .cell-code}\nset.seed(42)\nd_split <- initial_split(penguins)\nd_train <- training(d_split)\nd_test <- testing(d_split)\n```\n:::\n\n\n\nWorkflow:\n\n\n::: {.cell hash='tidymodels-penguins01_cache/html/unnamed-chunk-3_062772eea0767d6b7ad2cdf3a2c50b1e'}\n\n```{.r .cell-code}\nrec1 <-\n  recipe(body_mass_g ~ bill_length_mm, data = d_train) %>% \n  step_naomit(all_numeric())\n\nlm_mod <-\n  linear_reg()\n\nwflow <-\n  workflow() %>%\n  add_recipe(rec1) %>%\n  add_model(lm_mod)\n\nwflow\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n══ Workflow ════════════════════════════════════════════════════════════════════\nPreprocessor: Recipe\nModel: linear_reg()\n\n── Preprocessor ────────────────────────────────────────────────────────────────\n1 Recipe Step\n\n• step_naomit()\n\n── Model ───────────────────────────────────────────────────────────────────────\nLinear Regression Model Specification (regression)\n\nComputational engine: lm \n```\n:::\n:::\n\n\n\nBacken:\n\n\n::: {.cell hash='tidymodels-penguins01_cache/html/unnamed-chunk-4_dbca1363159ec8f9243f2319f1ef83f1'}\n\n```{.r .cell-code}\nd_baked <- prep(rec1) %>% bake(new_data = NULL)\nd_baked %>% head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 2\n  bill_length_mm body_mass_g\n           <dbl>       <int>\n1           36          3450\n2           50.9        3675\n3           46.1        4500\n4           45.8        4150\n5           48.6        5800\n6           39          3650\n```\n:::\n:::\n\n\nAuf NA prüfen:\n\n\n::: {.cell hash='tidymodels-penguins01_cache/html/unnamed-chunk-5_ae802b58cb5230fbb8dc3cbd06a92a36'}\n\n```{.r .cell-code}\nsum(is.na(d_baked))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0\n```\n:::\n:::\n\n\n\n\n\nCV:\n\n\n::: {.cell hash='tidymodels-penguins01_cache/html/unnamed-chunk-6_2cb36b2707305cef78ceacb7a803b644'}\n\n```{.r .cell-code}\nset.seed(42)\nfolds <- vfold_cv(d_train, v = 5)\nfolds\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#  5-fold cross-validation \n# A tibble: 5 × 2\n  splits           id   \n  <list>           <chr>\n1 <split [206/52]> Fold1\n2 <split [206/52]> Fold2\n3 <split [206/52]> Fold3\n4 <split [207/51]> Fold4\n5 <split [207/51]> Fold5\n```\n:::\n:::\n\n\n\n\nResampling:\n\n\n::: {.cell hash='tidymodels-penguins01_cache/html/unnamed-chunk-7_2e9e82543229768a59eb98c16ce23b42'}\n\n```{.r .cell-code}\npenguins_resamples <-\n  fit_resamples(\n    wflow,\n    resamples = folds\n  )\npenguins_resamples\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Resampling results\n# 5-fold cross-validation \n# A tibble: 5 × 4\n  splits           id    .metrics         .notes          \n  <list>           <chr> <list>           <list>          \n1 <split [206/52]> Fold1 <tibble [2 × 4]> <tibble [0 × 3]>\n2 <split [206/52]> Fold2 <tibble [2 × 4]> <tibble [0 × 3]>\n3 <split [206/52]> Fold3 <tibble [2 × 4]> <tibble [0 × 3]>\n4 <split [207/51]> Fold4 <tibble [2 × 4]> <tibble [0 × 3]>\n5 <split [207/51]> Fold5 <tibble [2 × 4]> <tibble [0 × 3]>\n```\n:::\n:::\n\n\n\nLast Fit:\n\n\n\n\n::: {.cell hash='tidymodels-penguins01_cache/html/unnamed-chunk-8_31e9899d67fdba629e29748d9a485006'}\n\n```{.r .cell-code}\npenguins_last <- last_fit(wflow, d_split)\n```\n:::\n\n\n\nModellgüte im Test-Sample:\n\n\n::: {.cell hash='tidymodels-penguins01_cache/html/unnamed-chunk-9_d618fd054d0a599ea9b6516eb3cfacde'}\n\n```{.r .cell-code}\npenguins_last %>% collect_metrics()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 4\n  .metric .estimator .estimate .config             \n  <chr>   <chr>          <dbl> <chr>               \n1 rmse    standard     652.    Preprocessor1_Model1\n2 rsq     standard       0.385 Preprocessor1_Model1\n```\n:::\n:::\n\n\n\n\nR-Quadrat:\n\n\n\n::: {.cell hash='tidymodels-penguins01_cache/html/unnamed-chunk-10_6ba0e6bfdf8597feaea638a30a54d7b8'}\n\n```{.r .cell-code}\nsol <-  collect_metrics(penguins_last)[[\".estimate\"]][2]\nsol\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.3850608\n```\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n\n\n---\n\nCategories: \n\n- ds1\n- tidymodels\n- prediction\n- yacsda\n- statlearning\n- num\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}