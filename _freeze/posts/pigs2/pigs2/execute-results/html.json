{
  "hash": "ce2088eb0a6185e0a216744e6ccb3e1e",
  "result": {
    "engine": "knitr",
    "markdown": "---\nexname: pigs2\nextype: num\nextol: 1\nexsolution: r sol\ncategories:\n- bayes\n- qm2\n- qm2-pruefung\n- regression\n- exam-22\ndate: '2023-01-11'\nslug: pigs2\ntitle: pigs2\n\n---\n\n\n\n\n\n\n\n\n\n\n\n# Aufgabe\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)  # Datenjudo\nlibrary(rstanarm)  # Bayes-Inferenz\nlibrary(easystats)  # Komfort\n```\n:::\n\n\nLaden Sie den Datensatz `toothgrowth`, z.B. von [dieser Quelle](https://vincentarelbundock.github.io/Rdatasets/csv/datasets/ToothGrowth.csv).\nIn dem Datensatz sind die Daten eines einfaches Experiments berichtet.\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\nIn dem Experiment wird der (kausale) Effekt verschiedener Darreichungsformen und Konzentrationen von Vitamin C auf das Zahnwachstum von Meerschweinchen untersucht. \n\nForschungsfrage:\n\nHat die Dosis (`dose`) einen (kausalen) Effekt auf die AV, Zahnlänge (`len`)?\n\nWir gehen mal einfach davon aus, dass der Faktor experimentell (also randomisiert und auf Störeffekte hin kontrollliert) veraeicht wurde. Sonst wäre eine Kausalinterpretation nicht (ohne Weiteres) möglich.\n\n\n\nAufgabe: *Berechnen Sie die Breite eines 95%-HDI für den Effekt!*\n\n\n\n\n[Hinweise](https://start-bayes.netlify.app/pruefung#bearbeitungshinweise)\n\n\n\n\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n\n# Lösung\n\n1. Schritt: Modell berechnen\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm2 <- stan_glm(len ~ dose, data = d,\n                seed = 42,\n                refresh = 0)\n```\n:::\n\n\nZur Erinnerung: Bei der Regressionsformel gilt immer `av ~  uv`.\n\n\n2. Schritt: Posteriori-Verteilung betrachten\n\nMit `parameters()` kriegt man einen guten Überblick über die Modellparameter:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nparameters(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nParameter   | Median |        95% CI |   pd |  Rhat |     ESS |                   Prior\n---------------------------------------------------------------------------------------\n(Intercept) |   7.40 | [4.84,  9.96] | 100% | 0.999 | 3881.00 | Normal (18.81 +- 19.12)\ndose        |   9.76 | [7.81, 11.76] | 100% | 0.999 | 4144.00 |  Normal (0.00 +- 30.41)\n```\n\n\n:::\n:::\n\n\nDas Modell zeigt einen positiven Effekt für `dose`:\n\nPro Einheit von `dose` steigt die Zahnlänge (`len`) um ca. 8-12 mm im Schnitt (laut unserem Modell).\n\n*Null* ist nicht im Intervall enthalten;\ndie Nullhypothese ist demnach *auszuschließen* (falls das jemanden interessiert).\nMan sagt, man *verwirft* die Nullhypothese (oder weist sie zurück).\n\nDas können wir auch plotten:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(parameters(lm2))\n```\n\n::: {.cell-output-display}\n![](unnamed-chunk-5-1.png){fig-pos='H' width=384}\n:::\n:::\n\n\nMan kann sich auch ein HDI direkt ausgeben, ohne die sonstigen Informationen, die `parameters()` ausgibt:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhdi(lm2, ci = .95)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nHighest Density Interval\n\nParameter   |       95% HDI\n---------------------------\n(Intercept) | [4.96, 10.06]\ndose        | [7.77, 11.70]\n```\n\n\n:::\n:::\n\n\nWie wir sehen, wird im Standard ein 95%-Intervall berichtet,\nwie in der Aufgabenstellung verlangt. \n\nWieder sehen wir, die Null ist *nicht* im Intervall enthalten. \nNull ist also *kein* plausibler Wert für den gesuchten Effekt (laut unserem Modell).\n\nSchauen wir uns mal zum Vergleich die Stichproben-Daten an:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd %>% \n  ggplot(aes(y = len, x = dose)) +\n  geom_point() +\n  geom_smooth(method = \"lm\")\n```\n\n::: {.cell-output-display}\n![](unnamed-chunk-7-1.png){fig-pos='H' width=384}\n:::\n:::\n\n\nMan sieht deutlich einen positiven Effekt: Die Regressionsgerade steigt.\n\n\nDie Breite des Schätzintervalls für den Effekt beträgt also:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsol <- 11.70 - 7.77\nsol\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3.93\n```\n\n\n:::\n:::\n\n\n\n\n\n---\n\nCategories: \n\n- bayes\n- ~\n- regression\n- exam-22\n\n",
    "supporting": [
      "pigs2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}