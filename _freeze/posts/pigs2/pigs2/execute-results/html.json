{
  "hash": "cec38d9a1b72d2c6923f9d7b0bf8d92b",
  "result": {
    "engine": "knitr",
    "markdown": "---\nexname: pigs2\nextype: num\nextol: 1\nexsolution: r sol\ncategories:\n- bayes\n- qm2\n- qm2-pruefung2023\n- regression\n- exam-22\ndate: '2023-01-11'\nslug: pigs2\ntitle: pigs2\n\n---\n\n\n\n\n\n\n\n\n\n\n\n\n# Aufgabe\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)  # Datenjudo\nlibrary(rstanarm)  # Bayes-Inferenz\nlibrary(easystats)  # Komfort\n```\n:::\n\n\n\nLaden Sie den Datensatz `toothgrowth`, z.B. von [dieser Quelle](https://vincentarelbundock.github.io/Rdatasets/csv/datasets/ToothGrowth.csv).\nIn dem Datensatz sind die Daten eines einfaches Experiments berichtet.\n\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\nIn dem Experiment wird der (kausale) Effekt verschiedener Darreichungsformen und Konzentrationen von Vitamin C auf das Zahnwachstum von Meerschweinchen untersucht. \n\nForschungsfrage:\n\nHat die Dosis (`dose`) einen (kausalen) Effekt auf die AV, Zahnlänge (`len`)?\n\nWir gehen mal einfach davon aus, dass der Faktor experimentell (also randomisiert und auf Störeffekte hin kontrollliert) veraeicht wurde. Sonst wäre eine Kausalinterpretation nicht (ohne Weiteres) möglich.\n\n\n\nAufgabe: *Berechnen Sie die Breite eines 95%-HDI für den Effekt!*\n\n\n\n\n[Hinweise](https://start-bayes.netlify.app/pruefung#bearbeitungshinweise)\n\n\n\n\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n\n# Lösung\n\n1. Schritt: Modell berechnen\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm2 <- stan_glm(len ~ dose, data = d,\n                seed = 42,\n                refresh = 0)\n```\n:::\n\n\n\nZur Erinnerung: Bei der Regressionsformel gilt immer `av ~  uv`.\n\n\n2. Schritt: Posteriori-Verteilung betrachten\n\nMit `parameters()` kriegt man einen guten Überblick über die Modellparameter:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nparameters(lm2)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|Parameter   |   Median|   CI|   CI_low|   CI_high| pd|      Rhat|      ESS|Prior_Distribution | Prior_Location| Prior_Scale|\n|:-----------|--------:|----:|--------:|---------:|--:|---------:|--------:|:------------------|--------------:|-----------:|\n|(Intercept) | 7.404367| 0.95| 4.841285|  9.957746|  1| 0.9994476| 3881.400|normal             |       18.81333|    19.12329|\n|dose        | 9.759631| 0.95| 7.808405| 11.758601|  1| 0.9994879| 4144.048|normal             |        0.00000|    30.40886|\n\n</div>\n:::\n:::\n\n\n\nDas Modell zeigt einen positiven Effekt für `dose`:\n\nPro Einheit von `dose` steigt die Zahnlänge (`len`) um ca. 8-12 mm im Schnitt (laut unserem Modell).\n\n*Null* ist nicht im Intervall enthalten;\ndie Nullhypothese ist demnach *auszuschließen* (falls das jemanden interessiert).\nMan sagt, man *verwirft* die Nullhypothese (oder weist sie zurück).\n\nDas können wir auch plotten:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(parameters(lm2))\n```\n\n::: {.cell-output-display}\n![](unnamed-chunk-5-1.png){fig-pos='H' width=384}\n:::\n:::\n\n\n\nMan kann sich auch ein HDI direkt ausgeben, ohne die sonstigen Informationen, die `parameters()` ausgibt:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhdi(lm2, ci = .95)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|Parameter   |   CI|   CI_low|  CI_high|Effects |Component   |\n|:-----------|----:|--------:|--------:|:-------|:-----------|\n|(Intercept) | 0.95| 4.959402| 10.06051|fixed   |conditional |\n|dose        | 0.95| 7.769051| 11.70019|fixed   |conditional |\n\n</div>\n:::\n:::\n\n\n\nWie wir sehen, wird im Standard ein 95%-Intervall berichtet,\nwie in der Aufgabenstellung verlangt. \n\nWieder sehen wir, die Null ist *nicht* im Intervall enthalten. \nNull ist also *kein* plausibler Wert für den gesuchten Effekt (laut unserem Modell).\n\nSchauen wir uns mal zum Vergleich die Stichproben-Daten an:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd %>% \n  ggplot(aes(y = len, x = dose)) +\n  geom_point() +\n  geom_smooth(method = \"lm\")\n```\n\n::: {.cell-output-display}\n![](unnamed-chunk-7-1.png){fig-pos='H' width=384}\n:::\n:::\n\n\n\nMan sieht deutlich einen positiven Effekt: Die Regressionsgerade steigt.\n\n\nDie Breite des Schätzintervalls für den Effekt beträgt also:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsol <- 11.70 - 7.77\nsol\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3.93\n```\n\n\n:::\n:::\n\n\n\n\n\n\n---\n\nCategories: \n\n- bayes\n- ~\n- regression\n- exam-22\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}