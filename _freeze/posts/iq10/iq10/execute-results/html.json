{
  "hash": "91ab5b05fbdaf3ddf142edfbff6a7b65",
  "result": {
    "engine": "knitr",
    "markdown": "---\nexname: iq10\nextype: num\nexsolution: 0.5\nexshuffle: no\nextol: 0.03\nexpoints: 1\ncategories:\n- probability\n- simulation\n- normal-distribution\n- bayes\n- bayes-grid\n- num\n- qm2\n- qm2-pruefung\ndate: '2023-11-08'\nslug: iq10\ntitle: iq10\n\n---\n\n\n\n\n\n\n\n\n\n\n# Aufgabe\n\nEine Forscherin, Prof. Weiss-Ois, untersucht den Effekt von Cannabis auf die Intelligenz.\n\nDazu untersucht Sie die Intelligenz langjähriger Konsumentis.\n\nProf. Weiss-Ois geht apriori von gleichverteilter Intelligenz aus. \nIhre zentrale Hypothese ist $\\mu = 90\\pm5$.\n \n\nMit großer Spannung wurden die Messdaten zur Intelligenz erwartet (die erst nach langem Streit über die zu verwendenden Intelligenztests erhoben werden konnten).\nInsgesamt wurden $N=541$ Personen untersucht.\n\n\nTatsächlich sei die wahre IQ-Verteilung jener Cannabis-Konsumentis wie folgt: $IQ \\sim N(92.5, 7.5)$. \nNatürlich kennt die Forscherin diese Verteilung nicht.\n\n*Wie wahrscheinlich ist die Hypothese der Forscherin im Lichte der Daten?*\n\n\n\nHinweise:\n\n- Nutzen Sie Simulationsmethoden.\n- Geben Sie Anteile oder Wahrscheinlichkeiten stets mit zwei Dezimalstellen an (sofern nicht anders verlangt).\n- Simulieren Sie $n=10^4$ Stichproben.\n- Nutzen Sie die Zahl 42 als Startwert für Ihre Zufallszahlen (um die Reproduzierbarkeit zu gewährleisten).\n- Gitterwerte für die Intelligenz könnten z.B. 75 bis 130 sein.\n\n\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n\n# Lösung\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n\n\nZunächst basteln wir die Bayes-Box:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- 100\n\nset.seed(42)\npostvert <-\n  tibble(p_grid = seq(from = 75, to = 130, length.out = n),\n         prior  = 1) %>% \n  mutate(likelihood = dnorm(x = p_grid, mean = 92.5, sd = 7.5)) %>% \n  mutate(unstand_post = likelihood * prior,\n         post = unstand_post / sum(unstand_post))\n```\n:::\n\n\n\nWarum `75` bis `130`? Das ist ein beliebiger Wert,\nin dem Sinne, dass Sie sich inhaltlich überlegen müssen,\nwelchen Wertebereich Sie für plausibel halten.\nUntersucht man IQ-Mittelwerte so erscheint (mir) ein Wertebereich von 75 bis 130 mehr als ausreichend.\nUntersucht man Mittelwerte der Körpergröße (heutiger Menschen in bekannten Zivilisationen) so erscheint (mir) ein Wertebereich von 140 cm bis 200cm als ausreichend.\n\n\nAus der Post-Verteilung ziehen wir Stichproben:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\npostvert_stipros <-\n  postvert %>% \n  slice_sample(\n    n = 1e4,\n    weight_by = post,\n    replace = T) %>% \n  select(p_grid)\n```\n:::\n\n\nDamit haben wir unsere Stichproben-Post-Verteilung.\n\nDa `slice_sample` auch zufällig Stichproben zieht,\nmüssen wir auch hier die Zufallszahlen fixieren, wenn\nwir die exakt gleichen Ergebnisse reproduzieren wollen.\n\n\nJetzt schauen wir (mit Spannung), wie hoch die Wahrscheinlichkeit ist für Parameterwete (`p_grid`) innerhalb des Intervalls wie von der Forscherin vorgegeben.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npostvert_stipros %>% \n  count(between(p_grid, left = 85, right = 95))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 2\n  `between(p_grid, left = 85, right = 95)`     n\n  <lgl>                                    <int>\n1 FALSE                                     5002\n2 TRUE                                      4998\n```\n\n\n:::\n:::\n\n\n\n`between` ist eine Komfortfuntion; ins Deutsche übersetzt sagt die Syntax:\n\n```\nNimm die Tabelle postvert_stipros und dann ...\n  zähle den Anteil der Werte von p_grid zwischen 85 und 95.\n```\n\nDie Wahrscheinlichkeit der Hypothese der Forscherin beträgt also ca. 50%.\n\nOb das viel oder weniger ist, ist eine subjektive Frage.\nDas beste Vorgehen wäre jetzt, die Hypothesen anderer Forschis dagegen zu legen.\nDann würde man sehen, welche Hypothese am besten zu den Daten passt.\n\n\n\nBasteln wir zum Vergleich eine Bayes-Box mit Gitterwerte von von 60 bis 145:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- 100\n\nset.seed(42)\npostvert2 <-\n  tibble(p_grid = seq(from = 60, to = 145, length.out = n),\n         prior  = 1) %>% \n  mutate(likelihood = dnorm(x = p_grid, mean = 92.5, sd = 7.5)) %>% \n  mutate(unstand_post = likelihood * prior,\n         post = unstand_post / sum(unstand_post))\n\nset.seed(42)\npostvert_stipros2 <-\n  postvert2 %>% \n  slice_sample(\n    n = 1e4,\n    weight_by = post,\n    replace = T) %>% \n  select(p_grid)\n```\n:::\n\n\n\nOb sich das Ergebnis ändert, jetzt, da wir einen breiteren Bereich an Gitterwerten untersuchzen?\n\nJetzt schauen wir wieder (mit Spannung), wie hoch die Wahrscheinlichkeit ist für Parameterwete (`p_grid`) innerhalb des Intervalls wie von der Forscherin vorgegeben.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npostvert_stipros2 %>% \n  count(between(p_grid, left = 85, right = 95)) %>% \n  mutate(prop = n/sum(n))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 3\n  `between(p_grid, left = 85, right = 95)`     n  prop\n  <lgl>                                    <int> <dbl>\n1 FALSE                                     5455 0.546\n2 TRUE                                      4545 0.454\n```\n\n\n:::\n:::\n\n\nDie Ergebnisse sind leicht anders als oben, wo wir den engeren Wertebereich als mögliche Werte angegeben haben.\n\nAber bedenken Sie: Wir behaupten in `postvert2` ernsthaft, dass ein *Mittelwert* der Intelligenz in dieser Population mit gleicher Wascheinlichkeit 60 oder 145 sein könnte!\nLaut [Wikipedia](https://de.wikipedia.org/wiki/Intelligenzminderung) beginnt mit 130 die Hochbegabung und unter 85 fängt die Lernbehinderung an.\nDass diese Menschen super schlau oder mental behindert sind, erscheint uns gleich plausibel.\nDas ist eine *sehr starke* Apriori-Verteilung!\n\nViel konservativer wäre zu sagen: \"Okay, vermutlich sind diese Menschen so schlau wie alle anderen auch,\nvielleicht etwas mehr oder etwas weniger. Aber mit sehr hoher Wahrscheinlichkeit sind sie im Durchschnitt keine Einsteins oder nicht extrem mental eingeschränkt.\"\n\nWir brauchen also besser *nicht* gleichverteilte Priori-Verteilungen.\nDazu an anderer Stelle mehr.\n\n\n\n\n\n\n\n---\n\nCategories: \n\n- probability\n- simulation\n- normal-distribution\n- bayes\n- bayes-grid\n- num\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}