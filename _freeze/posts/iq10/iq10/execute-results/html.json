{
  "hash": "0b26c4ce61a2f4276e2b0c17ce0fce24",
  "result": {
    "markdown": "---\nexname: iq10\nextype: num\nexsolution: 0.5\nexshuffle: no\nextol: 0.03\nexpoints: 1\ncategories:\n- probability\n- simulation\n- normal-distribution\n- bayes\n- bayes-box\ndate: '2022-11-11'\nslug: iq10\ntitle: iq10\n\n---\n\n\n\n\n\n\n\n\n\n\n# Exercise\n\nEine Forscherin, Prof. Weiss-Ois, untersucht den Effekt von Cannabis auf die Intelligenz.\n\nDazu untersucht Sie die Intelligenz langjähriger Konsumentis.\n\nProf. Weiss-Ois geht apriori von gleichverteilter Intelligenz. \nIhre zentrale Hypothese ist $\\mu = 90\\pm5$.\n \n\nMit großer Spannung wurden die Messdaten zur Intelligenz erwartet (die erst nach langem Streit über die zu verwendenden Intelligenztests erhoben werden konnten).\nInsgesamt wurden $N=541$ Personen untersucht.\n\n\nTatsächlich sei die wahre IQ-Verteilung jener Cannabis-Konsumentis wie folgt: $IQ \\sim N(92.5, 7.5)$. \nNatürlich kennt die Forscherin diese Verteilung nicht.\n\n*Wie wahrscheinlich ist die Hypothese der Forscherin im Lichte der Daten?*\n\n\n\nHinweise:\n\n- Nutzen Sie Simulationsmethoden.\n- Geben Sie Anteile oder Wahrscheinlichkeiten stets mit zwei Dezimalstellen an (sofern nicht anders verlangt).\n- Simulieren Sie $n=10^4$ Stichproben.\n- Nutzen Sie die Zahl 42 als Startwert für Ihre Zufallszahlen (um die Reproduzierbarkeit zu gewährleisten).\n\n\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n\n# Solution\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n\nSimulieren wir uns die Stichprobe:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nstipro <-\n  tibble(iq = rnorm(n = 541, mean = 92.5, sd = 7.5))\n```\n:::\n\n\n\nJetzt basteln wir die Bayes-Box:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- 100\n\nset.seed(42)\npostvert <-\n  tibble(p_grid = seq(from = 75, to = 130, length.out = n),\n         prior  = 1) %>% \n  mutate(likelihood = dnorm(x = p_grid, mean = 92.5, sd = 7.5)) %>% \n  mutate(unstand_post = (likelihood * prior),\n         post = unstand_post / sum(unstand_post))\n```\n:::\n\n\n\nDaraus ziehen wir Stichproben:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\npostvert_stipros <-\n  postvert %>% \n  slice_sample(\n    n = 1e4,\n    weight_by = post,\n    replace = T) %>% \n  select(p_grid)\n```\n:::\n\n\nDa `slice_sample` auch zufällig Stichproben zieht,\nmüssen wir auch hier die Zufallszahlen fixieren, wenn\nwir die exakt gleichen Ergebnisse reproduzieren wollen.\n\n\nJetzt schauen wir (mit Spannung), wie hoch die Wahrscheinlichkeit ist für Parameterwete (`p_grid`) innerhalb des Intervalls wie von der Forscherin vorgegeben.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npostvert_stipros %>% \n  count(between(p_grid, left = 85, right = 95))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 2\n  `between(p_grid, left = 85, right = 95)`     n\n  <lgl>                                    <int>\n1 FALSE                                     5002\n2 TRUE                                      4998\n```\n:::\n:::\n\n\n\n`between` ist eine Komfortfuntion; ins Deutsche übersetzt sagt die Syntax:\n\n```\nNimm die Tabelle postvert_stipros und dann ...\n  zähle den Anteil der Werte von p_grid zwischen 85 und 95.\n```\n\nDie Wahrscheinlichkeit der Hypothese der Forscherin beträgt ca. 50%.\n\nOb das viel oder weniger ist, ist eine subjektive Frage.\nDas beste Vorgehen wäre jetzt, die Hypothesen anderer Forschis dagegen zu legen.\nDann würde man sehen, welche Hypothese am besten zu den Daten passt.\n\n\n\n\n\n---\n\nCategories: \n\n- probability\n- simulation\n- normal-distribution\n- bayes\n- bayes-box\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}