{
  "hash": "dbf028a6eb1eb6054643de720420bc46",
  "result": {
    "markdown": "---\nextype: string\nexsolution: NA\nexname: rethink-3m4\nexpoints: 1\ncategories:\n- bayes\n- ppv\n- probability\ndate: '2022-11-05'\nslug: ReThink3m4\ntitle: ReThink3m4\n\n---\n\n---\noutput: html_document\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n\n\n\n\n\n\n\n\n\n\n# Exercise\n\n\n\n\nNehmen wir an, wir haben 8 (Wasser-)\"Treffer\" ($W=8$) bei 15 Würfen ($N=15$) erhalten (wieder im Globusversuch).\n\nBerechnen Sie auf Basis dieser Posteriori-Verteilung (8 Treffer bei 15 Würfen) die Wahrscheinlichkeit für 6 Wasser bei 9 Würfen ($W=6, N=9$).\n\nHinweise:\n\n- Berechnen Sie eine Bayes-Box (Gittermethode).\n- Verwenden Sie 1000 Gitterwerte.\n- Fixieren Sie die Zufallszahlen mit dem Startwert 42, d.h. `set.seed(42)`.\n- Gehen Sie von einem gleichverteilten Prior aus.\n\n\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n\n# Solution\n\n\nErstellen wir zuerst wieder die Posteriori-Verteilung für den Globusversuch. \n\n\n\n::: {.cell hash='ReThink3m4_cache/html/unnamed-chunk-1_22321fc08aa3c674de92958ebbe9ee14'}\n\n```{.r .cell-code}\np_grid <- seq( from=0 , to=1 , length.out=1000 )  # Gitterwerte\n\nprior <- rep( 1 , 1000 )  # Priori-Gewichte\n\nset.seed(42)\nlikelihood <- dbinom( 6 , size=9 , prob=p_grid ) \n\nunstandardisierte_posterior <- likelihood * prior \n\nposterior <- unstandardisierte_posterior / sum(unstandardisierte_posterior)\n```\n:::\n\n\nDann ziehen wir unsere Stichproben daraus:\n\n\n::: {.cell hash='ReThink3m4_cache/html/unnamed-chunk-2_5e0624afb948edf1ad9584f891cf0250'}\n\n```{.r .cell-code}\n# um die Zufallszahlen festzulegen, damit alle die gleichen Zufallswerte bekommen: \nset.seed(100) \n\n# Stichproben ziehen aus der Posteriori-Verteilung\nsamples <- \n  tibble(\n    p = sample( p_grid , prob=posterior, size=1e4, replace=TRUE)) \n```\n:::\n\n\n\nJetzt erstellen wir die PPV für einen *anderen* Versuch, nämlich mit 9 Zügen:\n\n\n\n::: {.cell hash='ReThink3m4_cache/html/unnamed-chunk-3_445f1ae59a8066431272c2cc5a522d36'}\n\n```{.r .cell-code}\nPPV <-\n  samples %>% \n  mutate(anzahl_wasser2 = rbinom(1e4, size = 9, prob = p))\n```\n:::\n\n\n\nSchließlich zählen wir,\nwie oft 6 Treffer beobachtet werden:\n\n\n::: {.cell hash='ReThink3m4_cache/html/unnamed-chunk-4_dabc643c2306bc620c3e35f1131987a3'}\n\n```{.r .cell-code}\nPPV %>% \n  count(anzahl_wasser2 == 6) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 2\n  `anzahl_wasser2 == 6`     n\n  <lgl>                 <int>\n1 FALSE                  8059\n2 TRUE                   1941\n```\n:::\n:::\n\n\n\n\n[Quelle](https://sr2-solutions.wjakethompson.com/bayesian-inference.html#chapter-3)\n\n\n\n\n---\n\nCategories: \n\n- bayes\n- ppv\n- probability\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}