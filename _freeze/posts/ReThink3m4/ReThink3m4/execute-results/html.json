{
  "hash": "7e924d92f4c539b71fd6d489c188ccf7",
  "result": {
    "engine": "knitr",
    "markdown": "---\nextype: string\nexsolution: NA\nexname: rethink3m4\nexpoints: 1\ncategories:\n- bayes\n- ppv\n- probability\n- string\ndate: '2023-11-08'\nslug: ReThink3m4\ntitle: ReThink3m4\n\n---\n\n\n\n\n\n\n\n\n\n\n\n\n\n# Aufgabe\n\n\n\n\nNehmen wir an, wir haben 8 (Wasser-)\"Treffer\" ($W=8$) bei 15 Würfen ($N=15$) erhalten (wieder im Globusversuch).\n\nBerechnen Sie auf Basis dieser Posteriori-Verteilung (8 Treffer bei 15 Würfen) die Wahrscheinlichkeit für 6 Wasser bei 9 Würfen ($W=6, N=9$).\n\nHinweise:\n\n- Berechnen Sie eine Bayes-Box (Gittermethode).\n- Verwenden Sie 1000 Gitterwerte.\n- Fixieren Sie die Zufallszahlen mit dem Startwert 42, d.h. `set.seed(42)`.\n- Gehen Sie von einem gleichverteilten Prior aus.\n\n\n\n*Quelle*: McElreath, R. (2020). *Statistical rethinking: A Bayesian course with examples in R and Stan* (2. Aufl.). Taylor and Francis, CRC Press.\n\n\n\n\n\n\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n\n# Lösung\n\n\nErstellen wir zuerst wieder die Posteriori-Verteilung für den Globusversuch. \n\n\n\n::: {.cell hash='ReThink3m4_cache/html/unnamed-chunk-1_1097d51802ddb02342e5677d4654f162'}\n\n```{.r .cell-code}\np_grid <- seq( from=0 , to=1 , length.out=1000 )  # Gitterwerte\n\nprior <- rep( 1 , 1000 )  # Priori-Gewichte\n\nset.seed(42)\nlikelihood <- dbinom( 6 , size=9 , prob=p_grid ) \n\nunstandardisierte_posterior <- likelihood * prior \n\nposterior <- unstandardisierte_posterior / sum(unstandardisierte_posterior)\n```\n:::\n\n\nDann ziehen wir unsere Stichproben daraus:\n\n\n::: {.cell hash='ReThink3m4_cache/html/unnamed-chunk-2_2a233c666001b2ba01406e036cfe5f69'}\n\n```{.r .cell-code}\n# um die Zufallszahlen festzulegen, damit alle die gleichen Zufallswerte bekommen: \nset.seed(42) \n\n# Stichproben ziehen aus der Posteriori-Verteilung\nsamples <- \n  tibble(\n    p = sample( p_grid , prob=posterior, size=1e4, replace=TRUE)) \n```\n:::\n\n\n\nJetzt erstellen wir die PPV für einen *anderen* Versuch, nämlich mit 9 Zügen:\n\n\n\n::: {.cell hash='ReThink3m4_cache/html/unnamed-chunk-3_5350ad1c0cabb064e9c9b0340c198eb0'}\n\n```{.r .cell-code}\nPPV <-\n  samples %>% \n  mutate(anzahl_wasser2 = rbinom(1e4, size = 9, prob = p))\n```\n:::\n\n\n\nSchließlich zählen wir,\nwie oft 6 Treffer beobachtet werden:\n\n\n::: {.cell hash='ReThink3m4_cache/html/unnamed-chunk-4_a9fe2535891d5aa134f4003232e1a346'}\n\n```{.r .cell-code}\nPPV %>% \n  count(anzahl_wasser2 == 6) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 2\n  `anzahl_wasser2 == 6`     n\n  <lgl>                 <int>\n1 FALSE                  7972\n2 TRUE                   2028\n```\n\n\n:::\n:::\n\n\n\n\n[Quelle](https://sr2-solutions.wjakethompson.com/bayesian-inference.html#chapter-3)\n\n\n\n\n---\n\nCategories: \n\n- bayes\n- ppv\n- probability\n- string\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}