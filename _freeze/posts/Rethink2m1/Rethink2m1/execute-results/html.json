{
  "hash": "d03e50780598deb31e3d090e20af33b9",
  "result": {
    "engine": "knitr",
    "markdown": "---\nextype: string\nexsolution: NA\nexname: rethink2m1\nexpoints: 1\ncategories:\n- probability\n- bayes-grid\n- rethink-chap2\n- string\ndate: '2023-11-08'\nslug: Rethink2m1\ntitle: Rethink2m1\n\n---\n\n\n\n\n\n\n\n\n\n\n\n\n\n# Aufgabe\n\nThis question is taken from McElreath, R. (2020). *Statistical rethinking: A Bayesian course with examples in R and Stan* (2. Ed.). Taylor and Francis, CRC Press.\n\n\n2M1. Recall the globe tossing model from the chapter. Compute and plot the grid approximate posterior distribution for each of the following sets of observations. In each case, assume a uniform prior for *p*.\n\n\n1. WWW\n2. WWWL\n3. LWWLWWW\n\n\n\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n\n# Lösung\n\nThe solution is taken from [this source](https://sr2-solutions.wjakethompson.com/bayesian-inference.html).\n\n\n\n::: {.cell hash='Rethink2m1_cache/html/unnamed-chunk-1_5592e307e70e4679354444309b9a58a9'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\ndist <- \n  tibble(\n    # Gridwerte bestimmen:\n    p_grid = seq(from = 0, to = 1, length.out = 20),\n    # Priori-Wskt bestimmen:\n    prior = rep(1, times = 20)) %>%\n  mutate(\n    # Likelihood berechnen:\n    likelihood_1 = dbinom(3, size = 3, prob = p_grid),  # WWW\n    likelihood_2 = dbinom(3, size = 4, prob = p_grid),  # WWWL\n    likelihood_3 = dbinom(5, size = 7, prob = p_grid),  # LWWLWWW\n    # unstand. Posterior-Wskt:\n    unstand_post_1 = likelihood_1 * prior,\n    unstand_post_2 = likelihood_2 * prior,\n    unstand_post_3 = likelihood_3 * prior,\n    # stand. Post-Wskt:\n    std_post_1 = unstand_post_1 / sum(unstand_post_1),\n    std_post_2 = unstand_post_2 / sum(unstand_post_2),\n    std_post_3 = unstand_post_3 / sum(unstand_post_3)\n    ) \n```\n:::\n\n\nHier ist die Bayes-Box:\n\n\n::: {.cell hash='Rethink2m1_cache/html/unnamed-chunk-2_d666ce335f45ef72e9790e63b23c4340'}\n\n```{.r .cell-code}\nknitr::kable(round(dist, 2))\n```\n\n::: {.cell-output-display}\n\n\n| p_grid| prior| likelihood_1| likelihood_2| likelihood_3| unstand_post_1| unstand_post_2| unstand_post_3| std_post_1| std_post_2| std_post_3|\n|------:|-----:|------------:|------------:|------------:|--------------:|--------------:|--------------:|----------:|----------:|----------:|\n|   0.00|     1|         0.00|         0.00|         0.00|           0.00|           0.00|           0.00|       0.00|       0.00|       0.00|\n|   0.05|     1|         0.00|         0.00|         0.00|           0.00|           0.00|           0.00|       0.00|       0.00|       0.00|\n|   0.11|     1|         0.00|         0.00|         0.00|           0.00|           0.00|           0.00|       0.00|       0.00|       0.00|\n|   0.16|     1|         0.00|         0.01|         0.00|           0.00|           0.01|           0.00|       0.00|       0.00|       0.00|\n|   0.21|     1|         0.01|         0.03|         0.01|           0.01|           0.03|           0.01|       0.00|       0.01|       0.00|\n|   0.26|     1|         0.02|         0.05|         0.01|           0.02|           0.05|           0.01|       0.00|       0.01|       0.01|\n|   0.32|     1|         0.03|         0.09|         0.03|           0.03|           0.09|           0.03|       0.01|       0.02|       0.01|\n|   0.37|     1|         0.05|         0.13|         0.06|           0.05|           0.13|           0.06|       0.01|       0.03|       0.02|\n|   0.42|     1|         0.07|         0.17|         0.09|           0.07|           0.17|           0.09|       0.01|       0.05|       0.04|\n|   0.47|     1|         0.11|         0.22|         0.14|           0.11|           0.22|           0.14|       0.02|       0.06|       0.06|\n|   0.53|     1|         0.15|         0.28|         0.19|           0.15|           0.28|           0.19|       0.03|       0.07|       0.08|\n|   0.58|     1|         0.19|         0.33|         0.24|           0.19|           0.33|           0.24|       0.04|       0.09|       0.10|\n|   0.63|     1|         0.25|         0.37|         0.29|           0.25|           0.37|           0.29|       0.05|       0.10|       0.12|\n|   0.68|     1|         0.32|         0.40|         0.31|           0.32|           0.40|           0.31|       0.06|       0.11|       0.13|\n|   0.74|     1|         0.40|         0.42|         0.32|           0.40|           0.42|           0.32|       0.08|       0.11|       0.13|\n|   0.79|     1|         0.49|         0.41|         0.29|           0.49|           0.41|           0.29|       0.09|       0.11|       0.12|\n|   0.84|     1|         0.60|         0.38|         0.22|           0.60|           0.38|           0.22|       0.11|       0.10|       0.09|\n|   0.89|     1|         0.72|         0.30|         0.13|           0.72|           0.30|           0.13|       0.14|       0.08|       0.06|\n|   0.95|     1|         0.85|         0.18|         0.04|           0.85|           0.18|           0.04|       0.16|       0.05|       0.02|\n|   1.00|     1|         1.00|         0.00|         0.00|           1.00|           0.00|           0.00|       0.19|       0.00|       0.00|\n\n\n:::\n:::\n\n\n\n\nJetzt können wir das jeweilige Diagramm zeichnen:\n\n\n\n::: {.cell hash='Rethink2m1_cache/html/unnamed-chunk-3_7b60e99bdd1b51edbf10d9d9d0bbb913'}\n\n```{.r .cell-code}\nlibrary(ggpubr)\nggline(dist,\n       x = \"p_grid\",\n       y = \"std_post_1\")\n```\n\n::: {.cell-output-display}\n![](unnamed-chunk-3-1.png){fig-pos='H' width=384}\n:::\n:::\n\n\n\nOder mit `ggplot2`:\n\n\n\n::: {.cell hash='Rethink2m1_cache/html/unnamed-chunk-4_51a474dcdbbb1fc0538fc1d4fb8b4eb0'}\n\n```{.r .cell-code}\nggplot(dist) +\n  aes(x = p_grid, y= std_post_1) +\n  geom_line()+\n  geom_point() +\n  labs(x = \"p(W)\",\n       y = \"Posteriori-Wahrscheinlichkeit\",\n       title = \"Daten: WWW\")\n```\n\n::: {.cell-output-display}\n![](unnamed-chunk-4-1.png){fig-pos='H' width=384}\n:::\n\n```{.r .cell-code}\nggplot(dist) +\n  aes(x = p_grid, y= std_post_2) +\n  geom_line()+\n  geom_point() +\n  labs(x = \"p(W)\",\n       y = \"Posteriori-Wahrscheinlichkeit\",\n       title = \"Daten: WWWL\")\n```\n\n::: {.cell-output-display}\n![](unnamed-chunk-4-2.png){fig-pos='H' width=384}\n:::\n\n```{.r .cell-code}\nggplot(dist) +\n  aes(x = p_grid, y= std_post_3) +\n  geom_line()+\n  geom_point() +\n  labs(x = \"p(W)\",\n       y = \"Posteriori-Wahrscheinlichkeit\",\n       title = \"Daten: LWWLWWW\")\n```\n\n::: {.cell-output-display}\n![](unnamed-chunk-4-3.png){fig-pos='H' width=384}\n:::\n:::\n\n\n\n\n\n---\n\nCategories: \n\n- probability\n- bayes-grid\n- rethink-chap2\n- string\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}