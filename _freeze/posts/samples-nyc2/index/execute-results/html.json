{
  "hash": "cf1fb9782659c8173a8109cde7e9c56c",
  "result": {
    "engine": "knitr",
    "markdown": "---\n# gleich diese Datei in einem Ordner mit Namen der Aufgabe abspeichern!\ndate: 2024-09-11  # HEUTIGES DATUM EINTRAGEN, nicht \"today\"\ndraft: FALSE   # ACHTUNG DRAFT STEHT AUF TRUE!\ntitle: samples-nyc2\nexecute: \n  cache: true\n  eval: true \nhighlight-style: arrow \ncache: true\ntoc: true\nnumber-sections: true\nextype: string\nexsolution: \"\"\nexshuffle: no\ncategories:\n- inference  # ENTER CATEGORIES HERE\n- story\n- yacsda\n\nformat:\n  html: \n   df-print: \"kable\"\n\nbibliography: \"../../library-ses.bib\"\n\n\n---\n\n\n\n\n\n\n# Aufgabe\n\n\nDrei Studierende arbeiten für die New Yorker Flughafenbehörde als Werkstudenten.\nFragt ihre Chefin eines Tages: \n\"Welcher der drei New Yorker Flughäfen hat im Schnitt die höchste Verspätung? Zieht mal eine kleine Stichprobe und gebt mir eine gute Antwort.\"\n\n\n\n*Studi A* überlegt: \"Hm, ich schaue mir mal die ersten 1000 Flüge des Jahres und diesen Mittelwert nehme ich als Schätzwert für die Verspätung des ganzen Jahres.\"\n\n*Studi B* argumentiert so: \"Hm, ich nehme die ersten 100 Flüge von jedem Monat, rechne davon den Mittelwert aus. Das ist dann mein Schätzwert für die Verspätung des ganzen Jahres, pro Flughafen.\"\n\n\n*Studi C* hingegen ist folgender Meinung: \"Ich ziehe mal eine Zufallsstichprobe, habe ich in der Statistik-Vorlesung gelernt. N=100 sollte genügen.\"\n\n\nDie Chefin bezieht sich übrigens auf das Jahr 2023.\n\n\n**Aufgabe:** Welcher der drei Studis macht die beste Vorhersage? Rechnen Sie nach und begründen Sie Ihre Meinung!\n\n\n\n# Lösung\n\n\n## Setup\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(nycflights23)  # Dataset \"flights\"\ndata(\"flights\")\nlibrary(tidyverse)\n```\n:::\n\n\nWie viele Flüge gab es?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnrow(flights)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 435352\n```\n\n\n:::\n:::\n\n\nViele!\n\n\nWelche Variablen gibt es im Datensatz?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(flights)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 435,352\nColumns: 19\n$ year           <int> 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2023, 2…\n$ month          <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…\n$ day            <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…\n$ dep_time       <int> 1, 18, 31, 33, 36, 503, 520, 524, 537, 547, 549, 551, 5…\n$ sched_dep_time <int> 2038, 2300, 2344, 2140, 2048, 500, 510, 530, 520, 545, …\n$ dep_delay      <dbl> 203, 78, 47, 173, 228, 3, 10, -6, 17, 2, -10, -9, -7, -…\n$ arr_time       <int> 328, 228, 500, 238, 223, 808, 948, 645, 926, 845, 905, …\n$ sched_arr_time <int> 3, 135, 426, 2352, 2252, 815, 949, 710, 818, 852, 901, …\n$ arr_delay      <dbl> 205, 53, 34, 166, 211, -7, -1, -25, 68, -7, 4, -13, -14…\n$ carrier        <chr> \"UA\", \"DL\", \"B6\", \"B6\", \"UA\", \"AA\", \"B6\", \"AA\", \"UA\", \"…\n$ flight         <int> 628, 393, 371, 1053, 219, 499, 996, 981, 206, 225, 800,…\n$ tailnum        <chr> \"N25201\", \"N830DN\", \"N807JB\", \"N265JB\", \"N17730\", \"N925…\n$ origin         <chr> \"EWR\", \"JFK\", \"JFK\", \"JFK\", \"EWR\", \"EWR\", \"JFK\", \"EWR\",…\n$ dest           <chr> \"SMF\", \"ATL\", \"BQN\", \"CHS\", \"DTW\", \"MIA\", \"BQN\", \"ORD\",…\n$ air_time       <dbl> 367, 108, 190, 108, 80, 154, 192, 119, 258, 157, 164, 1…\n$ distance       <dbl> 2500, 760, 1576, 636, 488, 1085, 1576, 719, 1400, 1065,…\n$ hour           <dbl> 20, 23, 23, 21, 20, 5, 5, 5, 5, 5, 5, 6, 5, 6, 6, 6, 6,…\n$ minute         <dbl> 38, 0, 44, 40, 48, 0, 10, 30, 20, 45, 59, 0, 59, 0, 0, …\n$ time_hour      <dttm> 2023-01-01 20:00:00, 2023-01-01 23:00:00, 2023-01-01 2…\n```\n\n\n:::\n:::\n\n\nNehmen wir `dep_delay` als Zielvariable.\nDie Chefin hat nicht genau gesagt, welche Variable sie meint. Da sieht man es mal wieder: Man muss Annahmen treffen. Ist aber auch schön, denn man kann selber entscheiden, was einem besser gefällt.\n\n\n## Los geht's\n\n### Studentin A\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nestimate_A <-\nflights |> \n  select(dep_delay, origin) |> \n  drop_na() |> \n  slice(1:1000) |> \n  group_by(origin) |> \n  summarise(dep_delay = mean(dep_delay))\n\nestimate_A\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|origin | dep_delay|\n|:------|---------:|\n|EWR    |      26.1|\n|JFK    |      19.9|\n|LGA    |       9.4|\n\n</div>\n:::\n:::\n\n\n\n\"Klares (?) Ergebnis! EWR, also Newark, hat die größte Verspätung!\"\n\n\n### Student B\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nestimate_B <-\nflights |> \n  select(dep_delay, origin, month) |> \n  drop_na() |> \n  group_by(month, origin) |> \n  slice(1:100) |> \n  summarise(dep_delay = mean(dep_delay)) |> \n  group_by(origin) |> \n  summarise(dep_delay = mean(dep_delay))\n\nestimate_B\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|origin | dep_delay|\n|:------|---------:|\n|EWR    |      8.47|\n|JFK    |      9.74|\n|LGA    |      0.76|\n\n</div>\n:::\n:::\n\n\n\"Knapp! EWR hat fast so viel Verspätung wie JFK.\"\n\n\n### Studentin C\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(73)\n\nestimate_C <-\nflights |> \n  select(dep_delay, origin) |> \n  drop_na() |> \n  sample_n(size = 100)  |> \n  group_by(origin) |> \n  summarise(dep_delay = mean(dep_delay))\n\nestimate_C\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|origin | dep_delay|\n|:------|---------:|\n|EWR    |       2.0|\n|JFK    |      14.3|\n|LGA    |       8.8|\n\n</div>\n:::\n:::\n\n\n\n\"Glasklares (?) Ergebnis! JFK, also John-F-Kennedy, hat die größte Verspätung! Newark ist hingegen superpünktlich!\"\n\n\n\n## Moment\n\nLeider entbrennt hier ein Streit.\nVermutlich einige Eifersuchtsmomente hinter den Kulissen, aber wir wissen nichts Genaues.\n\n\n\n\nStudentin A: \"So ein Quatsch, C, du hast die Zufallszahl auf 73 festgelegt, warum gerade diese Zahl?! Bei einer anderen Zahl könnte ein ganz andere Stichprobe und damit ein ganz anderes Ergebnis herauskommen!\"\n\n\nStudentin C: \"Ich habe kürzlich gelernt, dass [nicht 42, sondern 73 die beste Zahl ist](https://www.youtube.com/watch?v=hvn8-LzqKQo&t=7s). Also musste ich 73 nehmen!\n\nStudent B: \"Aber was *käme* heraus, wenn du 42 als Zufallszahl nehmen würdest, nur mal theoretisch?\"\n\n\nStudentin C: \"Äh...\"\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nflights |> \n  select(dep_delay, origin) |> \n  drop_na() |> \n  sample_n(size = 100)  |> \n  group_by(origin) |> \n  summarise(dep_delay = mean(dep_delay))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|origin | dep_delay|\n|:------|---------:|\n|EWR    |      28.3|\n|JFK    |       7.5|\n|LGA    |       9.9|\n\n</div>\n:::\n:::\n\n\n\nStudentin C: \"Äh, also... Das spielt doch gar keine Rolle, was rauskommt, denn *bei jeder Zahl* kann ja was anderes rauskommen.\"\n\n\nA: \"Du müsstest also dein Vorgehen ändern... Jede Zahl ausprobieren oder so.\"\n\n\nC: \"Liebe A, du mit deinen Flügen vom Jahresbeginn, das ist doch totaler Quatsch, an deiner Stelle wäre ich lieber still.\"\n\n\nA: \"Aber es kommt was Gutes raus mit meiner Methode!\"\n\nB: \"Woher willst du überhaupt wissen, ob es was Gutes ist?\"\n\nA: \"Wirst schon sehen!\"\n\n\nC: \"Puh, also gut, ich rechne noch mal. Ich zieh einfach ne Menge Stichproben, mit zufälligen Seed-Nummern ...\"\n\nA: \"Whatever!\"\n\nC: \"Moment.., hier kommt Newark, EWR.\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn_reps <- 100  # Anzahl von Stichproben\nsample_size <- 100  # Umfang jeder Stichprobe\n\newr_viele_schaetzwerte <-\n replicate(n_reps, flights |> \n                      select(dep_delay, origin) |> \n                      filter(origin == \"EWR\") |> \n                      drop_na() |> \n                      sample_n(size = sample_size) |> \n                      summarise(dep_delay = mean(dep_delay))) |> \n  as.numeric() |> \n  mean()\n\newr_viele_schaetzwerte\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 15\n```\n\n\n:::\n:::\n\n\n\nB: \"Wow, C, du bist halt schon die Statistik-Checkerin...\".\n\n\nA: \"Hey B, hör gefälligst auf, dich bei A einzuschmeicheln!\"\n\n\nB: \"Jedenfalls ist das Ergebnis von A ... anders als unsere!\"\n\n\nC: \"Hier noch mal mein Prinzip für die anderen Flughäfen. JFK:\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\njfk_viele_schaetzwerte <-\n replicate(n_reps, flights |> \n                      select(dep_delay, origin) |> \n                      filter(origin == \"JFK\") |> \n                      drop_na() |> \n                      sample_n(size = sample_size) |> \n                      summarise(dep_delay = mean(dep_delay))) |> \n  as.numeric() |> \n  mean()\n\njfk_viele_schaetzwerte\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 16\n```\n\n\n:::\n:::\n\n\n\nC: \"Und LaGuardia:\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlga_viele_schaetzwerte <-\n replicate(n_reps, flights |> \n                      select(dep_delay, origin) |> \n                      filter(origin == \"LGA\") |> \n                      drop_na() |> \n                      sample_n(size = sample_size) |> \n                      summarise(dep_delay = mean(dep_delay))) |> \n  as.numeric() |> \n  mean()\n\nlga_viele_schaetzwerte\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 11\n```\n\n\n:::\n:::\n\n\nC: \"Also, unterm Strich, LGA rules! LGA hat die geringste Verspätung im Schnitt, nach meiner Rechnung.\"\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlga_viele_schaetzwerte\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 11\n```\n\n\n:::\n\n```{.r .cell-code}\newr_viele_schaetzwerte\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 15\n```\n\n\n:::\n\n```{.r .cell-code}\njfk_viele_schaetzwerte\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 16\n```\n\n\n:::\n:::\n\n\n\n\n## Fazit?\n\n\nA: \"Okay, meine Methode war ein bisschen zu einfach. Aber hat auch am wenigsten Arbeit gemacht. Das nennt man wirtschaftlich vorgehen, nur darum geht's im Business. Also hab ich trotzdem gewonnen!\"\n\n\n\nB: \"Nope, mein Vorgehen ist in Wirklichkeit das Beste. Ich hab von *jedem* Monat 100 Flüge genommen, so hat sich alles super ausgeglichen, Jahreszeiten und so, glaub ich. Und es wäre nicht so viel Aufwand wie die zich Tausend Stichproben, die C gezogen hat.\"\n\n\n\nC: \"Kann ja alles sein, aber mein Vorgehen hat am meisten Spaß gemacht. Übrigens B, wir könnten uns, also unsere beiden Ideen, doch zusammenlegn, kombinieren. Das müsste ein super Ergebnis geben. Wollen wir zwei uns das mal zusammen anschauen, nur wir zwei?\"\n\n\n# Die Chefin meldet sich zu Wort\n\nChefin: \"Lasst mich da mal ran.\"\n\n\n## Wahre Verspätung\n\nDie Chefin berechnet die wahre Verspätung über alle Flüge 2023 (in YNC) insgesamt (also in der Population der NYC-Flüge von 2023):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwahre_verspaetung <- \n  flights |> \n  select(origin, dep_delay) |> \n  drop_na() |> \n  group_by(origin) |> \n  summarise(dep_delay = mean(dep_delay))\n\nwahre_verspaetung\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|origin | dep_delay|\n|:------|---------:|\n|EWR    |        15|\n|JFK    |        16|\n|LGA    |        11|\n\n</div>\n:::\n:::\n\n\n\nChefin: \"LaGuardia hat am wenigsten Verspätung. JFK am meisten, aber dicht gefolgt von EWR.\"\n\n\nChefin: \"Jetzt schauen wir mal, wer pro Flughafen am genauesten geschätzt hat.\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodellgueten <-\n  wahre_verspaetung |> \n  mutate(estimate_A = estimate_A$dep_delay,\n         estimate_B = estimate_B$dep_delay,\n         estimate_C = c(\n           ewr_viele_schaetzwerte,\n           jfk_viele_schaetzwerte,\n           lga_viele_schaetzwerte)\n  ) |> \n  pivot_longer(contains(\"estimate\"), \n               names_to = \"student\", \n               values_to = \"estimate\") |> \n  mutate(error_abs = abs(dep_delay - estimate)) \n```\n:::\n\n\n\nChefin: \"LaGuardia wurde ingesamt am genauesten geschätzt, von allen drei Studenten. Aber Studentin A überschätzt die Verspätung massiv bei Newark und bei JFK.\"\n\nChefin: \"Hier sind die Details.\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodellgueten |> \n  ggplot(aes(y = estimate, x = origin)) +\n # geom_line() +\n  geom_col(data = wahre_verspaetung,\n    aes(x = origin, y = dep_delay)) +\n  geom_col(aes(fill = student),\n    position = \"dodge\",\n    alpha = .8) +\n  labs(caption = \"black bars show true delay\",\n       y = \"estimated delay\",\n       fill = \"students' estimates\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/modellgueten-plot-1.png){width=672}\n:::\n:::\n\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-78630b1e679c78751184\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-78630b1e679c78751184\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\"],[\"EWR\",\"EWR\",\"EWR\",\"JFK\",\"JFK\",\"JFK\",\"LGA\",\"LGA\",\"LGA\"],[15.4,15.4,15.4,15.9,15.9,15.9,10.82,10.82,10.82],[\"estimate_A\",\"estimate_B\",\"estimate_C\",\"estimate_A\",\"estimate_B\",\"estimate_C\",\"estimate_A\",\"estimate_B\",\"estimate_C\"],[26.07,8.470000000000001,15.04,19.85,9.74,16.15,9.41,0.76,10.79],[10.67,6.93,0.37,3.95,6.16,0.24,1.41,10.06,0.03]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>origin<\\/th>\\n      <th>dep_delay<\\/th>\\n      <th>student<\\/th>\\n      <th>estimate<\\/th>\\n      <th>error_abs<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,4,5]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"origin\",\"targets\":1},{\"name\":\"dep_delay\",\"targets\":2},{\"name\":\"student\",\"targets\":3},{\"name\":\"estimate\",\"targets\":4},{\"name\":\"error_abs\",\"targets\":5}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n\n\n\n## And the winner is ...\n\nChefin: \"And the winner is ...\"\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodellgueten |> \n  ggplot(aes(x = student, y = error_abs)) +\n  geom_col()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nHier sieht man dass C am besten abschneidet, also die geringste absolute Abweichung von der wahren Verspätung hat.\nA und B schneiden schlechter ab.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodellgueten_summ <-\n  modellgueten |> \n  group_by(student) |> \n  summarise(error_abs = mean(error_abs)) |> \n  arrange(error_abs)\n\nmodellgueten_summ\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|student    | error_abs|\n|:----------|---------:|\n|estimate_C |      0.22|\n|estimate_A |      5.34|\n|estimate_B |      7.72|\n\n</div>\n:::\n:::\n\n\n\nChefin: \"Sieht so aus, als hätte C klar gewonnen. A und B sind deutlich schlechter.\"\n\n\nA: \"Mensch, C, du bist hier der Datenhecht!\"\n\nC: \"Ich glaub's ja nicht, ich meine, ich hab's immer gewusst!\"\n\nB: \"Moment, C hat nur gewonnen, weil sie so viele Stichproben gezogen hat. Das war doch totaler Overkill. Gibt's ja gar nicht in der Praxis.\"\n\ns\n\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/datatables-binding-0.33/datatables.js\"></script>\n<script src=\"../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}