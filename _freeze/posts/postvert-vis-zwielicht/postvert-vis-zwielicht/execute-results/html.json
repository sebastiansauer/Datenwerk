{
  "hash": "b57f16aae6d27d3b3c1b395b638ba3e3",
  "result": {
    "engine": "knitr",
    "markdown": "---\nexname: postvert-vis-zwielicht\nexpoints: 1\nextype: string\nexsolution: NA\ncategories:\n- 2023\n- vis\n- bayes\n- post\n- string\ndate: '2023-11-08'\nslug: postvert-vis-zwielicht\ntitle: postvert-vis-zwielicht\n\n---\n\n\n\n\n\n\n# Setup\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n\n\n# Aufgabe\n\n\n\n\n## Der zwielichte Dozent: Stichproben-Vert. vs. Post-Vert.\n\nIn einer dunklen Gasse fordert Sie ein Statistik-Dozent zu einem Glücksspiel heraus^[Hier bräuchte es ein passendes Meme; Vorschläge bitte an mich.]. Münzwurf; wenn er gewinnt, müssen Sie 10 Euro zahlen. Gewinnen Sie, bekommen Sie 11 Euro. Klingt nach einer guten Partie, nicht war? Natürlich nehmen Sie sofort an. \n\nSie spielen also Münzwurf; der Dozent setzt auf Zahl. Sie spielen 10 Runden. Leider gewinnt der Dozent 9 von 10 Mal^[was er mit lautem Gelächter quittiert].\n\n*Ist die Münze fair oder zieht der mich über den Tisch?*, das ist die Frage, \ndie Ihnen brennend durch den Kopf zieht.\n\n\"Sind 9 von 10 Treffern noch realistisch erwartbar, wenn es mit rechten Dingen zugeht,\noder beweist das Ergebnis, dass die Münze gezinkt ist?\"\n\nWütend (und mit leeren Taschen) ziehen Sie von dannen.\n\n\nZusammengefasst: Daten: 9 von 10 Treffern beim Münzwurf. Forschungsfrage: Ist die Münze fair?\n\n\nSchauen wir uns zunächst einmal an, wie wahrscheinlich 9 von 10 Treffern sind,\n*wenn* die Münze fair ist, s. @fig-stiprovert-post-zwielicht, links.\n\n\n\n::: {.cell}\n\n:::\n\n\nDie *Stichprobenverteilung* zeigt, wie wahrscheinlich die empirischen Daten $D$ (z.B. 9 von 10 Treffer) sind, *gegeben* eines Parameterwerts $\\pi$ (z.B. $p=0.5$): $Pr(D|\\pi)$^[Das griechische kleine $p$ wird \"pi\" genannt und $\\pi$ geschrieben. Zur Erinnerung: Parameter- oder Populationskennwerte werden in der Statistik häufig mit griechischen Buchstaben benannt, um sie von Stichprobenkennwerten abzugrenzen.].\n\nAnders gesagt, die Stichprobenverteilung zeigt die Verteilung der Likelihoods eines bestimmten Parameterwerts.\n\n\n\nIn der Bayes-Statistik ist die Post-Verteilung Dreh- und Angelpunkt der Entscheidung über eine Hypothese.\nIn @fig-stiprovert-post-zwielicht ist die Posteriori-Verteilung für die Daten zum zwielichten Dozent dargestellt.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Post-Verteilung:\nd_zwielicht <-\n  tibble(\n    p_grid = seq( from=0 , to=1 , length.out=100),\n    prior = 1,  # Priori-Gewichte\n    likelihood = dbinom(8, size = 10, prob=p_grid) ,\n    unstandardisierte_posterior = likelihood * prior ,\n    posterior = unstandardisierte_posterior / sum(unstandardisierte_posterior))\n\n\n# Stichproben ziehen aus der Posteriori-Verteilung:\nsamples_zwielicht <- \n  tibble(\n    gewinnchance_muenze = sample(\n      d_zwielicht$p_grid , \n      prob=d_zwielicht$posterior, \n      size=1e4, \n      replace=TRUE)) %>% \n  mutate(\n    id = row_number())\n```\n:::\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Post-Verteilung für den Parameter p zu den Daten des zwielichten Dozenten (9 von 10 Treffern im wiederholten Münzwurf)](postvert-vis-zwielicht_files/figure-html/fig-stiprovert-post-zwielicht-1.png){#fig-stiprovert-post-zwielicht width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngghistogram(samples_zwielicht,\n            x = \"gewinnchance_muenze\",\n            title = \"Posteriori-Verteilung für p\",\n            subtitle = \"Priori: Gleichverteilung; Daten: 9 von 10 Treffern, binomialverteilt\",\n            xlab = \"p (Gewinchance der Münze)\",\n            fill = \"grey60\") +\n  geom_vline(xintercept = 0.5)\n```\n:::\n\n\n\n\n**Aufgab:e** Bauen Sie daraufhin die oben gezeigte Abbildung nach.\n\nHinweise:\n\n- Orientieren Sie sich im Übrigen an den [allgemeinen Hinweisen des Datenwerks](https://datenwerk.netlify.app/hinweise).\n\n\n\n\n\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n\n# Lösung\n\n\n\nPakete starten:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggpubr)\n```\n:::\n\n\n\nPost-Verteilung erstellen:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd_zwielicht <-\n  tibble(\n    p_grid = seq( from=0 , to=1 , length.out=100),\n    prior = 1,  # Priori-Gewichte\n    likelihood = dbinom(8, size = 10, prob=p_grid) ,\n    unstandardisierte_posterior = likelihood * prior ,\n    posterior = unstandardisierte_posterior / sum(unstandardisierte_posterior))\n```\n:::\n\n\nStichproben ziehen aus der Posteriori-Verteilung:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples_zwielicht <- \n  tibble(\n    gewinnchance_muenze = sample(\n      d_zwielicht$p_grid , \n      prob=d_zwielicht$posterior, \n      size=1e4, \n      replace=TRUE)) %>% \n  mutate(\n    id = row_number())\n```\n:::\n\n\n\nVerteilung visualisieren, z.B. mit `ggpubr`:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngghistogram(samples_zwielicht,\n            x = \"gewinnchance_muenze\",\n            title = \"Posteriori-Verteilung für p\",\n            subtitle = \"Priori: Gleichverteilung; Daten: 9 von 10 Treffern, binomialverteilt\",\n            xlab = \"p (Gewinchance der Münze)\",\n            fill = \"grey60\") +\n  geom_vline(xintercept = 0.5)\n```\n\n::: {.cell-output-display}\n![](postvert-vis-zwielicht_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\nOder mit purem `ggplot`: \n\n\n::: {.cell}\n\n```{.r .cell-code}\np_samples_zwielicht <- \nsamples_zwielicht %>% \n  ggplot() +\n  aes(x = gewinnchance_muenze) +\n  geom_histogram(fill = \"grey60\", bins = 20) +\n  #geom_vline(xintercept = 0.9) +\n  #geom_label(x = 0.8, y= 0, label = \"Emp. Ergebnis\") +\n  labs(title = \"Posteriori-Verteilung für p\",\n       subtitle = \"Priori: Gleichverteilung; Daten: 9 von 10 Treffern, binomialverteilt\",\n       caption = \"Das Dreieck zeigt die Wahrscheinlichkeit eines Treffers bei einer fairen Münze\",\n       x = \"Gewinnchance der Münze\") +\n  annotate(\"point\", x = .5, y = 0, size = 5, color = \"grey40\", shape = 17)\n\np_samples_zwielicht\n```\n\n::: {.cell-output-display}\n![](postvert-vis-zwielicht_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\nEs reicht i.d.R. vollkommen, wenn Sie eine der beiden Möglichkeiten beherrschen.\n\nTipp: Fragen Sie ChatGPT and Friends nach dem R-Code.\n\n\n\n---\n\nCategories: \n\n- 2023\n- vis\n- bayes\n- post\n- string\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}