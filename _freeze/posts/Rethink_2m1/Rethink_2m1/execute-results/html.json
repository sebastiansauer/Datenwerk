{
  "hash": "2987bd125eedd6a098c48cf829c023a7",
  "result": {
    "markdown": "---\nextype: string\nexsolution: NA\nexname: rethink2m1\nexpoints: 1\ncategories:\n- probability\n- bayes-grid\ndate: '2022-10-24'\nslug: Rethink_2m1\ntitle: Rethink_2m1\n\n---\n\n\n\n\n\n\n\n\n\n\n\n\n\n# Exercise\n\nThis question is taken from McElreath, R. (2020). *Statistical rethinking: A Bayesian course with examples in R and Stan* (2. Ed.). Taylor and Francis, CRC Press.\n\n\n2M1. Recall the globe tossing model from the chapter. Compute and plot the grid approximate posterior distribution for each of the following sets of observations. In each case, assume a uniform prior for *p*.\n\n\n1. WWW\n2. WWWL\n3. LWWLWWW\n\n\n\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n\n# Solution\n\nThe solution is taken from [this source](https://sr2-solutions.wjakethompson.com/bayesian-inference.html).\n\n\n\n::: {.cell hash='Rethink_2m1_cache/html/unnamed-chunk-1_fdd329482f40dc412e1ed0717684c2ce'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\ndist <- \n  tibble(\n    # Gridwerte bestimmen:\n    p_grid = seq(from = 0, to = 1, length.out = 20),\n    # Priori-Wskt bestimmen:\n    prior = rep(1, times = 20)) %>%\n  mutate(\n    # Likelihood berechnen:\n    likelihood_1 = dbinom(3, size = 3, prob = p_grid),  # WWW\n    likelihood_2 = dbinom(3, size = 4, prob = p_grid),  # WWWL\n    likelihood_3 = dbinom(5, size = 7, prob = p_grid),  # LWWLWWW\n    # unstand. Posterior-Wskt:\n    unstand_post_1 = likelihood_1 * prior,\n    unstand_post_2 = likelihood_2 * prior,\n    unstand_post_3 = likelihood_3 * prior,\n    # stand. Post-Wskt:\n    std_post_1 = unstand_post_1 / sum(unstand_post_1),\n    std_post_2 = unstand_post_2 / sum(unstand_post_2),\n    std_post_3 = unstand_post_3 / sum(unstand_post_3)\n    ) \n```\n:::\n\n\nJetzt k√∂nnen wir das Diagramm zeichnen:\n\n\n::: {.cell hash='Rethink_2m1_cache/html/unnamed-chunk-2_12423dfa61743f1f66d20f90d274ecec'}\n\n```{.r .cell-code}\nggplot(dist) +\n  aes(x = p_grid, y= std_post_1) +\n  geom_line()+\n  geom_point() +\n  labs(x = \"p(W)\",\n       y = \"Posteriori-Wahrscheinlichkeit\",\n       title = \"Daten: WWW\")\n```\n\n::: {.cell-output-display}\n![](unnamed-chunk-2-1.png){fig-pos='H' width=384}\n:::\n\n```{.r .cell-code}\nggplot(dist) +\n  aes(x = p_grid, y= std_post_2) +\n  geom_line()+\n  geom_point() +\n  labs(x = \"p(W)\",\n       y = \"Posteriori-Wahrscheinlichkeit\",\n       title = \"Daten: WWWL\")\n```\n\n::: {.cell-output-display}\n![](unnamed-chunk-2-2.png){fig-pos='H' width=384}\n:::\n\n```{.r .cell-code}\nggplot(dist) +\n  aes(x = p_grid, y= std_post_3) +\n  geom_line()+\n  geom_point() +\n  labs(x = \"p(W)\",\n       y = \"Posteriori-Wahrscheinlichkeit\",\n       title = \"Daten: LWWLWWW\")\n```\n\n::: {.cell-output-display}\n![](unnamed-chunk-2-3.png){fig-pos='H' width=384}\n:::\n:::\n\n\n\nEtwas eleganter (und komplizierter) kann man es auch so in R schreiben ([Quelle](https://sr2-solutions.wjakethompson.com/bayesian-inference.html)):\n\n\n::: {.cell hash='Rethink_2m1_cache/html/unnamed-chunk-3_fa072ee411f0cd7a1a9aba2f3a4d4bfa'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\ndist <- tibble(p_grid = seq(from = 0, to = 1, length.out = 20),\n               prior = rep(1, times = 20)) %>%\n  mutate(likelihood_1 = dbinom(3, size = 3, prob = p_grid),\n         likelihood_2 = dbinom(3, size = 4, prob = p_grid),\n         likelihood_3 = dbinom(5, size = 7, prob = p_grid),\n         across(starts_with(\"likelihood\"), ~ .x * prior),\n         across(starts_with(\"likelihood\"), ~ .x / sum(.x))) %>%\n  pivot_longer(cols = starts_with(\"likelihood\"), names_to = \"pattern\",\n               values_to = \"posterior\") %>%\n  separate(pattern, c(NA, \"pattern\"), sep = \"_\", convert = TRUE) %>%\n  mutate(obs = case_when(pattern == 1L ~ \"W, W, W\",\n                         pattern == 2L ~ \"W, W, W, L\",\n                         pattern == 3L ~ \"L, W, W, L, W, W, W\"))\n\nggplot(dist, aes(x = p_grid, y = posterior)) +\n  facet_wrap(vars(fct_inorder(obs)), nrow = 1) +\n  geom_line() +\n  geom_point() +\n  labs(x = \"Proportion Water (p)\", y = \"Posterior Density\")\n```\n\n::: {.cell-output-display}\n![](unnamed-chunk-3-1.png){fig-pos='H' width=384}\n:::\n:::\n\n\n\n\n---\n\nCategories: \n\n- probability\n- bayes-grid\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}