{
  "hash": "25ce1120427e49c5c4b8e81da7fd624f",
  "result": {
    "markdown": "---\nextype: string\nexsolution: NA\nexname: rethink3e1-7\nexpoints: 1\ncategories:\n- bayes\n- probability\n- post\ndate: '2022-11-05'\nslug: ReThink3e1-7\ntitle: ReThink3e1-7\n\n---\n\n\n\n\n\n\n\n\n\n\n\n\n\n# Exercise\n\nErstellen Sie die Posteriori-Verteilung für den Globusversuch. Nutzen Sie dafür diese Syntax:\n\n\n\n::: {.cell hash='ReThink3e1-7_cache/html/unnamed-chunk-1_6add8120196c91ea966f2e7894d33e02'}\n\n```{.r .cell-code}\np_grid <- seq( from=0 , to=1 , length.out=1000 )  # Gitterwerte\n\nprior <- rep( 1 , 1000 )  # Priori-Gewichte\n\nlikelihood <- dbinom( 6 , size=9 , prob=p_grid ) \n\nunstandardisierte_posterior <- likelihood * prior \n\nposterior <- unstandardisierte_posterior / sum(unstandardisierte_posterior)\n\n# um die Zufallszahlen festzulegen, damit wir alle die gleichen Zahlen bekommen zum Schnluss: \nset.seed(42) \n\n# Stichproben ziehen aus der Posteriori-Verteilung\nsamples <- \n  tibble(\n    p = sample( p_grid , prob=posterior, size=1e4, replace=TRUE)) \n```\n:::\n\n\n\n\na) Wie viel Wahrscheinlichkeitsmasse liegt unter $p=0.2$?\n\nb) Wie viel Wahrscheinlichkeitsmasse liegt über $p=0.8$?\n\nc) Welcher Anteil der Posteriori-Verteilung liegt zwischen $p=0.2$ und $p=0.8$?\n\nd) Unter welchem Wasseranteil $p$ liegen 10% der Posteriori-Verteilung?\n\ne) Über welchem Wasseranteil $p$ liegen 10% der Posteriori-Verteilung?\n\nf) Welches *schmälstes* Intervall von $p$ enthält 66% der Posteriori-Wahrscheinlichkeit?\n\ng) Welcher Wertebereich (synonym: Welches Intervall) von $p$ enthält 66% der Posteriori-Wahrscheinlichkeit (hier wird *Posteriori-Wahrscheinlichkeit* synonym gebraucht zu *Posteriori-Verteilung*)? Wie nennt man diese Arten von Intervall?\n\n\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n\n# Solution\n\nEs finden sich auch Lösungsvorschläge online, z.B. [hier](https://github.com/jffist/statistical-rethinking-solutions/blob/master/ch03_hw.R)\n\na) Wie viel Wahrscheinlichkeitsmasse liegt unter $p=0.2$?\n\n\n::: {.cell hash='ReThink3e1-7_cache/html/unnamed-chunk-2_b45dddaf14642d827aed4f0eaffa1f78'}\n\n```{.r .cell-code}\nsamples %>% \n  count(p < 0.2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 2\n  `p < 0.2`     n\n  <lgl>     <int>\n1 FALSE      9993\n2 TRUE          7\n```\n:::\n:::\n\n\nFast nix!\n\n\n\nb) Wie viel Wahrscheinlichkeitsmasse liegt über $p=0.8$?\n\n\n\n::: {.cell hash='ReThink3e1-7_cache/html/unnamed-chunk-3_31142ae0805629db9f34a2fcbca35a48'}\n\n```{.r .cell-code}\nsamples %>% \n  count(p > 0.8)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 2\n  `p > 0.8`     n\n  <lgl>     <int>\n1 FALSE      8842\n2 TRUE       1158\n```\n:::\n:::\n\n\nNaja, so gut 10%!\n\n\n\n\nc)  Welcher Anteil der Posteriori-Verteilung liegt zwischen $p=0.2$ und $p=0.8$?\n\n\n\n\n::: {.cell hash='ReThink3e1-7_cache/html/unnamed-chunk-4_8b73c28d9b888debcc34dd43d782ec3c'}\n\n```{.r .cell-code}\nsamples %>% \n  count(p > 0.2 & p < 0.8) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 2\n  `p > 0.2 & p < 0.8`     n\n  <lgl>               <int>\n1 FALSE                1165\n2 TRUE                 8835\n```\n:::\n:::\n\n\nKnapp 90%!\n\n\n\nd) Unter welchem Wasseranteil $p$ liegen 20% der Posteriori-Verteilung?\n\n\nEine Möglichkeit: Wir sortieren $p$ der Größe nach (aufsteigend), filtern dann so, dass wir nur die ersten 20% der Zeilen behalten und schauen dann, was der größte Wert ist.\n\n\n::: {.cell hash='ReThink3e1-7_cache/html/unnamed-chunk-5_ec80e1cb43214d9c86aba4878d773da2'}\n\n```{.r .cell-code}\nsamples %>% \n  arrange(p) %>% \n  slice_head(prop = 0.2) %>% \n  summarise(quantil_20 = max(p))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  quantil_20\n       <dbl>\n1      0.517\n```\n:::\n:::\n\nAndererseits: Das, was wir gerade gemacht haben, nennt man auch ein *Quantil* berechnen, s. auch [hier](https://de.wikipedia.org/wiki/Quantil_%28Wahrscheinlichkeitstheorie%29). Dafür gibt's fertige Funktionen in R, wie `quantile()`:\n\n\n::: {.cell hash='ReThink3e1-7_cache/html/unnamed-chunk-6_183c418404fe9c29602128dc83e43973'}\n\n```{.r .cell-code}\nsamples %>% \n  summarise(q_20 = quantile(p, 0.2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n   q_20\n  <dbl>\n1 0.517\n```\n:::\n:::\n\n\n\n\n\ne) Über welchem Wasseranteil $p$ liegen 10% der Posteriori-Verteilung?\n\n\n\n::: {.cell hash='ReThink3e1-7_cache/html/unnamed-chunk-7_33d7bd02b191e11b0c9d4a28f8d1c100'}\n\n```{.r .cell-code}\nsamples %>% \n  summarise(quantile(p, 0.9))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  `quantile(p, 0.9)`\n               <dbl>\n1              0.810\n```\n:::\n:::\n\n\n\nMit 90% Wahrscheinlichkeit ist der Wasseranteil höchstns bei 81%.\n\n\n\nf) Welches *schmälstes* Intervall von $p$ enthält 66% der Posteriori-Wahrscheinlichkeit?\n\n\n\n::: {.cell hash='ReThink3e1-7_cache/html/unnamed-chunk-8_92df1b38a7ebeeac2ed7044bca2349ae'}\n\n```{.r .cell-code}\nlibrary(easystats)\nhdi(samples, ci = 0.66)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nHighest Density Interval\n\nParameter |      66% HDI\n------------------------\np         | [0.52, 0.79]\n```\n:::\n:::\n\n\n\n\n\n\n\ng) Welcher Wertebereich von $p$ enthält 66% der Posteriori-Wahrscheinlichkeit (hier wird *Posteriori-Wahrscheinlichkeit* syonyom gebraucht zu *Posteriori-Verteilung*)?\n\n\nWir nutzen hier die Equal-Tail-Intervall (oder Perzentilintervall genannt),\nda die Aufgabe keine genauen Angaben macht.\n\n\n::: {.cell hash='ReThink3e1-7_cache/html/unnamed-chunk-9_0cb00c140a69d189758bea8a17571d4b'}\n\n```{.r .cell-code}\neti(samples, ci = 0.66)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nEqual-Tailed Interval\n\nParameter |      66% ETI\n------------------------\np         | [0.50, 0.77]\n```\n:::\n:::\n\n\nEin \"mittleres\" 2/3-Intervall lässt 1/3 der Wahrscheinlichkeitsmasse außen vor, und zwar gleichmäßig in zwei Hälften links und rechts, also jeweils 1/6 (17%). So ein Intervall heißt *Perzentilintervall*. Daher synonym:\n\n\n::: {.cell hash='ReThink3e1-7_cache/html/unnamed-chunk-10_228c04a4aced2c2a6f76af3c6bf326f7'}\n\n```{.r .cell-code}\nsamples %>% \n  summarise(PI_66 = quantile(p, prob = c(0.17, .84)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 1\n  PI_66\n  <dbl>\n1 0.501\n2 0.779\n```\n:::\n:::\n\n\n\n\n\n\n\n---\n\nCategories: \n\n- bayes\n- probability\n- post\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}