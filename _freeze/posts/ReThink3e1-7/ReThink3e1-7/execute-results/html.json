{
  "hash": "e635a1c230bc0a838409b7f8aa23986c",
  "result": {
    "engine": "knitr",
    "markdown": "---\nextype: string\nexsolution: NA\nexname: rethink3e1-7\nexpoints: 1\ncategories:\n- bayes\n- probability\n- post\n- bayesbox\n- computer\ndate: '2022-11-23'\ntitle: rethink3e1-7\n\n\n---\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n# Exercise\n\nErstellen Sie die Posteriori-Verteilung für den Globusversuch. Nutzen Sie dafür diese Syntax:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np_grid <- seq( from=0 , to=1 , length.out=1000 )  # Gitterwerte\n\nprior <- rep( 1 , 1000 )  # Priori-Gewichte\n\nlikelihood <- dbinom( 6 , size=9 , prob=p_grid ) \n\nunstandardisierte_posterior <- likelihood * prior \n\nposterior <- unstandardisierte_posterior / sum(unstandardisierte_posterior)\n\n# um die Zufallszahlen festzulegen, damit wir alle die gleichen Zahlen bekommen zum Schnluss: \nset.seed(42) \n\n# Stichproben ziehen aus der Posteriori-Verteilung\nsamples <- \n  tibble(\n    p = sample( p_grid , prob=posterior, size=1e4, replace=TRUE)) \n```\n:::\n\n\n\n\n\n\na) Wie viel Wahrscheinlichkeitsmasse liegt unter $p=0.2$?\n\nb) Wie viel Wahrscheinlichkeitsmasse liegt über $p=0.8$?\n\nc) Welcher Anteil der Posteriori-Verteilung liegt zwischen $p=0.2$ und $p=0.8$?\n\nd) Unter welchem Wasseranteil $p$ liegen 10% der Posteriori-Verteilung?\n\ne) Über welchem Wasseranteil $p$ liegen 10% der Posteriori-Verteilung?\n\nf) Welches *schmälstes* Intervall von $p$ enthält 66% der Posteriori-Wahrscheinlichkeit?\n\ng) Welcher Wertebereich (synonym: Welches Intervall) von $p$ enthält 66% der Posteriori-Wahrscheinlichkeit (hier wird *Posteriori-Wahrscheinlichkeit* synonym gebraucht zu *Posteriori-Verteilung*)? Wie nennt man diese Arten von Intervall?\n\n\n*Quelle*: McElreath, R. (2020). *Statistical rethinking: A Bayesian course with examples in R and Stan* (2. Aufl.). Taylor and Francis, CRC Press.\n\n\n\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n\n# Solution\n\nHier ist eine Visualisierung der Posteriori-Verteilung:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggdensity(samples, x = \"p\")   # aus \"ggpubr\"\n```\n\n::: {.cell-output-display}\n![](rethink3e1-7_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n\n\nEs finden sich auch Lösungsvorschläge online, z.B. [hier](https://github.com/jffist/statistical-rethinking-solutions/blob/master/ch03_hw.R)\n\na) Wie viel Wahrscheinlichkeitsmasse liegt unter $p=0.2$?\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples %>% \n  count(p < 0.2)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|p < 0.2 |    n|\n|:-------|----:|\n|FALSE   | 9993|\n|TRUE    |    7|\n\n</div>\n:::\n:::\n\n\n\n\nFast nix!\n\n\n\nb) Wie viel Wahrscheinlichkeitsmasse liegt über $p=0.8$?\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples %>% \n  count(p > 0.8)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|p > 0.8 |    n|\n|:-------|----:|\n|FALSE   | 8842|\n|TRUE    | 1158|\n\n</div>\n:::\n:::\n\n\n\n\nNaja, so gut 10%!\n\n\n\n\nc)  Welcher Anteil der Posteriori-Verteilung liegt zwischen $p=0.2$ und $p=0.8$?\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples %>% \n  count(p > 0.2 & p < 0.8) \n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|p > 0.2 & p < 0.8 |    n|\n|:-----------------|----:|\n|FALSE             | 1165|\n|TRUE              | 8835|\n\n</div>\n:::\n:::\n\n\n\n\nKnapp 90%!\n\n\n\nd) Unter welchem Wasseranteil $p$ liegen 20% der Posteriori-Verteilung?\n\n\n\nEine Möglichkeit: Wir sortieren $p$ der Größe nach (aufsteigend), \nfiltern dann so, dass wir nur die ersten 20% der Zeilen behalten und schauen dann, was der größte Wert ist.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples %>% \n  arrange(p) %>% \n  slice_head(prop = 0.2) %>% \n  summarise(quantil_20 = max(p))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| quantil_20|\n|----------:|\n|  0.5165165|\n\n</div>\n:::\n:::\n\n\n\nAndererseits: Das, was wir gerade gemacht haben, nennt man auch ein *Quantil* berechnen, s. auch [hier](https://de.wikipedia.org/wiki/Quantil_%28Wahrscheinlichkeitstheorie%29). \nDafür gibt's fertige Funktionen in R, wie `quantile()`:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples %>% \n  summarise(q_20 = quantile(p, 0.2))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|      q_20|\n|---------:|\n| 0.5165165|\n\n</div>\n:::\n:::\n\n\n\n\n\n\n\ne) Über welchem Wasseranteil $p$ liegen 10% der Posteriori-Verteilung?\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples %>% \n  summarise(quantile(p, 0.9))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| quantile(p, 0.9)|\n|----------------:|\n|        0.8098098|\n\n</div>\n:::\n:::\n\n\n\n\n\nMit 90% Wahrscheinlichkeit ist der Wasseranteil höchstens bei 81%.\n\n\n\nf) Welches *schmälstes* Intervall von $p$ enthält 66% der Posteriori-Wahrscheinlichkeit?\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(easystats)\nhdi(samples, ci = 0.66)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|Parameter |   CI|    CI_low|   CI_high|\n|:---------|----:|---------:|---------:|\n|p         | 0.66| 0.5155155| 0.7857858|\n\n</div>\n:::\n:::\n\n\n\n\n\n\n\n\n\ng) Welcher Wertebereich von $p$ enthält 66% der Posteriori-Wahrscheinlichkeit (hier wird *Posteriori-Wahrscheinlichkeit* syonyom gebraucht zu *Posteriori-Verteilung*)?\n\n\nWir nutzen hier die Equal-Tail-Intervall (oder Perzentilintervall genannt),\nda die Aufgabe keine genauen Angaben macht.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\neti(samples, ci = 0.66)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|Parameter |   CI|    CI_low|   CI_high|\n|:---------|----:|---------:|---------:|\n|p         | 0.66| 0.5005005| 0.7747748|\n\n</div>\n:::\n:::\n\n\n\n\nEin \"mittleres\" 2/3-Intervall lässt 1/3 der Wahrscheinlichkeitsmasse außen vor, und zwar gleichmäßig in zwei Hälften links und rechts, also jeweils 1/6 (17%). So ein Intervall heißt *Perzentilintervall*. Daher synonym:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples %>% \n  summarise(PI_66 = quantile(p, prob = c(0.17, .84)))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|     PI_66|\n|---------:|\n| 0.5005005|\n| 0.7787788|\n\n</div>\n:::\n:::\n\n\n\n\n\n\n\n\n\n---\n\nCategories: \n\n- bayes\n- probability\n- post\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}