{
  "hash": "6c405fb70e832bacc61d8c0ade7704aa",
  "result": {
    "engine": "knitr",
    "markdown": "---\nextype: string\nexsolution: NA\nexname: nasa04\nexpoints: 1\ncategories:\n- data\n- eda\n- lagema√üe\n- vis\n- animation\n- string\ndate: '2023-05-05'\nslug: nasa04\ntitle: nasa04\n\n---\n\n\n\n\n\n\n\n# Aufgabe\n\n\nViele Quellen berichten Klimadaten unserer Erde, z.B. auch [National Aeronautics and Space Administration - Goddard Institute for Space Studies](https://data.giss.nasa.gov/gistemp/).\n\nVon dieser Quelle beziehen wir [diesen Datensatz](https://data.giss.nasa.gov/gistemp/tabledata_v4/GLB.Ts+dSST.csv).\n\n\nDie Datensatz sind auf der Webseite wie folgt beschrieben:\n\n\n*Tables of Global and Hemispheric Monthly Means and Zonal Annual Means*\n\nCombined Land-Surface Air and Sea-Surface Water Temperature Anomalies (Land-Ocean Temperature Index, L-OTI)\n\nThe following are plain-text files in tabular format of temperature anomalies, i.e. *deviations from the corresponding 1951-1980 means*.\n\n\n>   Global-mean monthly, seasonal, and annual means, 1880-present, updated through most recent month: TXT, CSV\n\nStarten Sie zun√§chst das R-Paket `tidyverse` falls noch nicht geschehen.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\nZum Animieren verwenden wir diese Pakete:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(gganimate)\nlibrary(plotly)\n```\n:::\n\n\n\nImportieren Sie dann die Daten:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndata_path <- \"https://data.giss.nasa.gov/gistemp/tabledata_v4/GLB.Ts+dSST.csv\"\nd <- read_csv(data_path, skip = 1)\n```\n:::\n\n\nWir lassen die 1. Zeile des Datensatzes aus (Argument `skip`), da dort *Metadaten* stehen,\nalso keine Daten, sondern Informationen (Daten) zu den eigentlichen Daten.\n\n\n**Aufgaben**\n\n1. Visualisieren Sie Temperatur pro Jahr und Dekade.\n3. BONUSAUFGABE: Animieren Sie Ihre Diagramme mittels `gganimate`.\n\n\nHinweise:\n\n- Sie m√ºssen zuerst die Dekade als neue Spalte berechnen.\n\n\n\n\n\n\n\n\n\n\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n\n# L√∂sung\n\n## Daten aufbereiten\n\nDekade berechnen:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nd <-\n  d %>% \n  mutate(decade = round(Year/10))\n```\n:::\n\n\n\nDie Temperaturdaten der Monate April bis Dezember sind als Textdaten (`character`) formatiert. Aber wir brauchen Zahlen zum Rechne.\nDaher m√ºssen wir noch in Zahlen umwandeln:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nd2 <-\n  d %>% \n  select(Year:Dec) %>% \n  mutate(across(Apr:Dec, as.numeric))\n```\n:::\n\nIns lange Format umwandeln:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nd3 <- \n  d2 %>% \n  pivot_longer(-Year, \n               values_to = \"temp\", \n               names_to = \"month\")\n```\n:::\n\n\nDie Monate sind wie folgt bezeichnet in den Daten:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmonth_vec <- c(\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\",\n               \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\",\n               \"Nov\", \"Dec\")\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmonths <-\n  tibble(\n    month = month_vec,\n    month_num = 1:12\n  )\n```\n:::\n\n\n\nUnd dann die Monatsnummer (1-12) zu den Daten (`d3`) hinzuf√ºgen. Das geht komfortabel mit einem Join:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nd4 <- \n  d3 %>% \n  full_join(months)\n```\n:::\n\n\n\n\n## Daten zusammenfassen\n\n\nStatistiken pro Dekade f√ºr *Januar*:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nd_summarized <- \n  d %>% \n  group_by(decade) %>% \n  summarise(temp_mean = mean(Jan),\n            temp_sd = sd(Jan))\n\nd_summarized\n```\n:::\n\n\n\n## Statisches Diagramm\n\nZur Veranschaulichung visualisieren wir die Ergebnisse:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nd_summarized %>% \n  pivot_longer(-decade) %>% \n  ggplot(aes(x = decade, y = value)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  facet_wrap(~ name)\n```\n\n::: {.cell-output-display}\n![](chunk-img/unnamed-chunk-11-1.png){fig-align='center' fig-pos='H' width=100%}\n:::\n:::\n\n\n\n\nAlternativ k√∂nnen Sie zum Visualisieren der Daten z.B. das Paket `ggpubr` nutzen:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(ggpubr)\nggscatter(d_summarized, x = \"decade\", y = \"temp_mean\", add = \"reg.line\")\n```\n\n::: {.cell-output-display}\n![](chunk-img/unnamed-chunk-12-1.png){fig-align='center' fig-pos='H' width=100%}\n:::\n:::\n\n\n\n\n## Animiertes Diagramm pro Dekade\n\nMit Punken:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np1 <- \n  d_summarized %>% \n  ggplot(aes(x = decade, y = temp_mean)) +\n  geom_point(aes(group = seq_along(decade))) \n\np1 + transition_reveal(decade) \n```\n\n::: {.cell-output-display}\n![](chunk-img/unnamed-chunk-13-1.gif){fig-align='center' fig-pos='H' width=100%}\n:::\n:::\n\n\n\nMit Linie:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np2 <- ggplot(d_summarized,\n            aes(x = decade, temp_mean)) +\n  geom_line()\np2 + transition_reveal(decade)\n```\n\n::: {.cell-output-display}\n![](chunk-img/unnamed-chunk-14-1.gif){fig-align='center' fig-pos='H' width=100%}\n:::\n:::\n\n\n\n## Animiertes Diagramm pro Jahr\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nd3 %>% \n  ggplot(aes(x = Year, y = temp)) +\n  geom_line() + \n  transition_reveal(Year)\n```\n\n::: {.cell-output-display}\n![](chunk-img/unnamed-chunk-15-1.gif){fig-align='center' fig-pos='H' width=100%}\n:::\n:::\n\n\n## Statisches Diagramm f√ºr alle Monate\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np3 <- d3 %>% \n  ggplot(aes(x = Year, y = temp, color = month, group = month)) +\n  geom_line() \n```\n:::\n\n\n\n## Animiertes Diagramm f√ºr alle Monate\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np3 + transition_reveal(Year) \n```\n\n::: {.cell-output-display}\n![](chunk-img/unnamed-chunk-17-1.gif){fig-align='center' fig-pos='H' width=100%}\n:::\n:::\n\n\n\n\n## Fazit\n\nFalls Sie Teile der R-Syntax nicht kennen: Machen Sie sich nichts daraus. Be happy üòÑ\n\n\n\n\n\n\n\n---\n\nCategories: \n\n- data\n- eda\n- lagema√üee\n- vis\n- animation\n- string\n\n",
    "supporting": [
      "nasa04_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}