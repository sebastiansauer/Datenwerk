{
  "hash": "3fc5ddf0169f5473958fbf8d97ac25fb",
  "result": {
    "engine": "knitr",
    "markdown": "---\nexname: euro-bayes\nextype: num\nexsolution: r 0.27\nexshuffle: no\nextol: 1\nexpoints: 1\ncategories:\n- probability\n- bayesbox\ndate: '2022-10-27'\nslug: euro-bayes\ntitle: euro-bayes\n\n---\n\n\n\n\n\n\n\n\n\n\n# Exercise\n\n\nIn *Information Theory, Inference, and Learning Algorithms*, stellt David MacKay folgendes Problem.\n\n\"A statistical statement appeared in The Guardian on Friday January 4, 2002:\n\nWhen spun on edge 250 times, a Belgian one-euro coin came up heads 140 times and tails 110. 'It looks very suspicious to me,' said Barry Blight, a statistics lecturer at the London School of Economics. 'If the coin were unbiased, the chance of getting a result as extreme as that would be less than 7%.'\n\nBut do these data give evidence that the coin is biased rather than fair?\"\n\n*Wie wahrscheinlich ist es, dass die Münze (exakt) fair ist, im Lichte dieser Daten?*\n\nHinweise:\n\n- Untersuchen Sie die Hypothesen $\\pi_0 = 0, \\pi_1 = 0.1, \\pi_2 = 0.2, ..., \\pi_{10} = 1$ für die Trefferwahrscheinlichkeit (Kopf; heads).\n- Erstellen Sie ein Bayes-Gitter zur Lösung dieser Aufgabe.\n- Gehen Sie davon aus, dass Sie indifferent gegenüber der Hypothesen zu den Parameterwerten der Münze sind.\n- Geben Sie Prozentzahlen immer als Anteil an und lassen Sie die führende Null weg (z.B. .42).\n\n\n\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n</br>\n\n# Solution\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggpubr)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nd <-\n  tibble(\n    # definiere die Hypothesen (das \"Gitter\"): \n    p_Gitter = seq(from = 0, to = 1, by = 0.1),\n    # bestimme den Priori-Wert:       \n    Priori  = 1) %>%  \n    mutate(\n      # berechne Likelihood für jeden Gitterwert:\n      Likelihood = dbinom(140, size = 250, prob = p_Gitter),\n      # berechen unstand. Posteriori-Werte:\n      unstd_Post = Likelihood * Priori,\n      # berechne stand. Posteriori-Werte (summiert zu 1):\n      Post = unstd_Post / sum(unstd_Post))  \n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n| p_Gitter| Priori| Likelihood| unstd_Post| Post|\n|--------:|------:|----------:|----------:|----:|\n|      0.0|      1|       0.00|       0.00| 0.00|\n|      0.1|      1|       0.00|       0.00| 0.00|\n|      0.2|      1|       0.00|       0.00| 0.00|\n|      0.3|      1|       0.00|       0.00| 0.00|\n|      0.4|      1|       0.00|       0.00| 0.00|\n|      0.5|      1|       0.01|       0.01| 0.27|\n|      0.6|      1|       0.02|       0.02| 0.73|\n|      0.7|      1|       0.00|       0.00| 0.00|\n|      0.8|      1|       0.00|       0.00| 0.00|\n|      0.9|      1|       0.00|       0.00| 0.00|\n|      1.0|      1|       0.00|       0.00| 0.00|\n\n\n:::\n:::\n\n\n\n\nPlotten mit `ggplot`:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd %>% \n  ggplot(aes(x=p_Gitter, y = Post)) +\n  geom_line()\n```\n\n::: {.cell-output-display}\n![](unnamed-chunk-4-1.png){fig-pos='H' width=384}\n:::\n:::\n\n\nOder mit `ggpubr` plotten:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggline(d, x = \"p_Gitter\", y = \"Post\", add = \"mean_se\", \n       xlab = \"Trefferwahrscheinlichkeit\", ylab = \"Posteriori-Wahrscheinlichkeit\")\n```\n\n::: {.cell-output-display}\n![](unnamed-chunk-5-1.png){fig-pos='H' width=75%}\n:::\n:::\n\n\n\n\n\nDie Wahrscheinlichkeit $Pr(\\pi = 1/2 \\, | \\, X=140)$ wenn $X \\sim Bin(250, 1/2)$ beträgt ca. 27% oder .27.\n\n*Allerdings* würden viele Statistiker:innen nicht (nur) fragen, wie wahrscheinlich 140 Treffer sind.\nStattdessen könnte man von folgender Überlegung ausgehen.\n\nZuerst: Welcher Wert wäre am wahrscheinlichsten, wenn die Münze fair wäre?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndbinom(x = 0:250, size = 250, prob = 1/2) %>% which.max()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 126\n```\n\n\n:::\n:::\n\n\n\nDer 126. Wert in der Liste `0:250` ist der wahrscheinlichste (also 125 Treffer).\n\nWenn die Münze fair ist, dann wären doch 15 Treffer *mehr* als 125 genauso so unwahrscheinlich wie 15 Treffer *weniger* als 125 Treffer.\nBeide Ereignisse - 110 und 140 Treffer - sind ja gleich weit entfernt von denjenigen Wert, der am wahrscheinlichsten ist, wenn die Münze fair ist.\n\nEine Statistikerin würde also eher fragen: \n\"Wie wahrscheinlich ist es, dass man ein Ergebnis erhält, dass mind. 15 Treffer *entfernt* ist von der Trefferzahl, die bei einer fairen Münze zu erwarten ist?\".\nAber genug davon für diese Aufgabe :-)\n\n\n\n---\n\nCategories: \n\n- probability\n- bayesbox\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}