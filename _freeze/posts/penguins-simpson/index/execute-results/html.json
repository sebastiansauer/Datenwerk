{
  "hash": "a6c59aedc44df485078ab0b23d4c1077",
  "result": {
    "engine": "knitr",
    "markdown": "---\n# gleich diese Datei in einem Ordner mit Namen der Aufgabe abspeichern!\ndate: 2024-10-10\ndraft: FALSE   # ACHTUNG DRAFT STEHT AUF TRUE!\ntitle: penguins-simpson  # HIER TITEL DES POSTS EINGEBEN.\nexecute: \n  \n  eval: true \nhighlight-style: arrow \ncache: true\ntoc: true\nnumber-sections: true\nextype: string\nexsolution: \"\"\nexshuffle: no\ncategories:\n- lm\n- bayes\n- regression\n- causal\n\n\nbibliography: \"../../library-ses.bib\"\n\n\n---\n\n\n\n\n\n\n\n# Aufgabe 1\n\nLaden Sie den Datensatz `penguins` (Palmerpenguins). Tipp: Es gibt ein R-Paket, in dem diese Daten wohnen. Im Skript [QM2](https://start-bayes.netlify.app/1050-schaetzen-testen#ben%C3%B6tigte-daten) finden sich diese Daten auch. \nOder im weiten Internet.\n\n\n## Modell 1\n\n### Modell berechnen\n\nBerechnen Sie ein Modell, um den Zusammenhang zwischen \nSchnabeltiefe (UV) und Körpergewicht (AV) statistisch zu schätzen.\n\n\n### Visualisieren Sie das Modell\n\nTipp 1: `estimate_relation()` aus dem Paket `easystats`, s. [QM1](https://statistik1.netlify.app/) oder QM2. Aber es gibt auch andere Wege. \n\nTipp 2: Fragen Sie ChatGPT.\n\n### Präzision der Koeffizienten\n\nGeben Sie die Präzision der Regressionskoeffizienten an. \nInterpretieren Sie das Ergebnis.\n\n\n## Modell 2: Gewicht als Funktion von Schnabeltiefe und von Spezies\n\n\n### Modell berechnen\n\nBerechnen Sie folgendes Modell: Gewicht als Funktion von Schnabeltiefe und von Spezies\n\n\n### Visualisieren Sie das Modell\n\nwie oben\n\n\n### Präzision der Koeffizienten\n\nVergleichen Sie die Präzision der Regressionskoeffizienten mit dem Modell 1. Interpretieren Sie das Ergebnis.\n\n\n\n\n\n</br>\n</br>\n</br>\n\n</br>\n</br>\n</br>\n\n</br>\n</br>\n</br>\n\n</br>\n</br>\n</br>\n\n\n\n\n\n\n\n\n\n\n\n# Lösung zu Aufgabe 1\n\n\n## Modell 1\n\n\nDaten importieren:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"penguins\", package = \"palmerpenguins\")\n```\n:::\n\n\n\nAchtung: Das Paket muss installiert sein.\n\n\n\nPakete starten:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(easystats)\n```\n:::\n\n\n\n\nModell berechnen mit `lm`, d.h. \"frequentistisch\":\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1_freq <- \n  lm(body_mass_g ~ bill_depth_mm, data = penguins)\n```\n:::\n\n\n\n\nMit Bayes:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rstanarm)  # Paket muss installiert sein\nm1_bayes <- \n  stan_glm(body_mass_g ~ bill_depth_mm, data = penguins,\n           refresh = 0)\n```\n:::\n\n\n\n\n\nModellparameter:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nparameters(m1_freq)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nParameter     | Coefficient |     SE |             95% CI | t(340) |      p\n---------------------------------------------------------------------------\n(Intercept)   |     7488.65 | 335.22 | [6829.29, 8148.01] |  22.34 | < .001\nbill depth mm |     -191.64 |  19.42 | [-229.84, -153.45] |  -9.87 | < .001\n```\n\n\n:::\n:::\n\n\n\nPro Millimeter Schnabeltiefe sinkt das Gewicht um knapp 200g, im Schnitt, laut Modell.\n\nDie Null ist NICHT im Schätzbereich enthalten, also können wir die Hypothese, dass der Zusammenhang zwischen Schnabeltiefe und Gewicht 0 ist, verwerfen.\n\nWir entscheiden uns also zu glauben, dass es einen Zusammenhang gibt. Wir können nicht ganz sicher sein, aber das Modell befürwortet diese Entscheidung.\n\nAllerdings sind wir nicht sicher, ob das ein Scheinzusammenhang ist oder ein \"echter\", d.h. kausaler Zusammenhang.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nparameters(m1_bayes)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nParameter     |  Median |             95% CI |   pd |  Rhat |     ESS |                       Prior\n---------------------------------------------------------------------------------------------------\n(Intercept)   | 7483.18 | [6853.18, 8102.24] | 100% | 1.000 | 4014.00 | Normal (4201.75 +- 2004.89)\nbill_depth_mm | -191.16 | [-227.38, -154.91] | 100% | 1.000 | 4001.00 |    Normal (0.00 +- 1015.24)\n```\n\n\n:::\n:::\n\n\n\nEin typischer Befund: Frequentistische und Bayes-Ergebnisse sind - bei genügend großen Stichproben - sehr ähnlich, was die Zahlen betrifft. Sehr unterschiedlich ist aber die Interpretation.\n\nBayes-Interpretation:\n\n\"Mit 95% Wahrscheinlichkeit liegt der Effekt zwischen -230g und 150g pro Millimeter Schnabeltiefe, laut dem Modell.\"\n\nFrequentistische Interpretation:\n\n\n\"Würde man sehhhr viele Stichproben aus der zugrundeliegenden Population ziehen und für jede Stichprobe ein 95%-Konfindenzintervall berechnen würde, dann würde in 95% der Fälle das wahre Populationsmittel in diesem Intervall liegen. In unserer konkreten Stichprobe lagen die Grenzen bei ca. -230 bis -150. Ob der wahre Wert in diesem bestimmten Intervall liegt, können wir aber nicht sagen.\"\n\n\n\nModell visualisieren:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nestimate_relation(m1_freq) |> plot()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/m1-plot-1.png){width=672}\n:::\n:::\n\n\n\n\n\n## Modell 2\n\n\n\n\nModell berechnen mit `lm`, d.h. \"frequentistisch\":\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm2_freq <- \n  lm(body_mass_g ~ bill_depth_mm + species, data = penguins)\n```\n:::\n\n\n\n\nMit Bayes:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rstanarm)  # Paket muss installiert sein\nm2_bayes <- \n  stan_glm(body_mass_g ~ bill_depth_mm + species, data = penguins, refresh = 0)\n```\n:::\n\n\n\n\n\nModellparameter:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nparameters(m2_freq)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nParameter           | Coefficient |     SE |              95% CI | t(338) |      p\n----------------------------------------------------------------------------------\n(Intercept)         |    -1007.28 | 323.56 | [-1643.73, -370.83] |  -3.11 | 0.002 \nbill depth mm       |      256.61 |  17.56 | [  222.07,  291.16] |  14.61 | < .001\nspecies [Chinstrap] |       13.38 |  52.95 | [  -90.77,  117.52] |   0.25 | 0.801 \nspecies [Gentoo]    |     2238.67 |  73.68 | [ 2093.74, 2383.60] |  30.38 | < .001\n```\n\n\n:::\n\n```{.r .cell-code}\nparameters(m2_bayes)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nParameter        |   Median |              95% CI |     pd |  Rhat |     ESS |                       Prior\n----------------------------------------------------------------------------------------------------------\n(Intercept)      | -1020.57 | [-1658.20, -384.09] | 99.90% | 1.000 | 2313.00 | Normal (4201.75 +- 2004.89)\nbill_depth_mm    |   257.45 | [  222.63,  291.87] |   100% | 1.000 | 2306.00 |    Normal (0.00 +- 1015.24)\nspeciesChinstrap |    12.68 | [  -90.53,  117.67] | 59.45% | 1.002 | 3678.00 |    Normal (0.00 +- 5015.92)\nspeciesGentoo    |  2239.94 | [ 2092.14, 2385.42] |   100% | 1.000 | 2669.00 |    Normal (0.00 +- 4171.63)\n```\n\n\n:::\n:::\n\n\n\nÄh, Moment ... Jetzt ist der Zusammenhang zwischen Schnabeltiefe und Gewicht nicht mehr *negativ*, sondern *POSITIV*?! Der Effekt geht in die entgegengesetzte Richtung? Kann das sein?!\n\n\n\nEin Bild zur Hilfe:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm2_freq |> estimate_relation() |> plot()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/m2-plot-1.png){width=672}\n:::\n:::\n\n\n\n\nTatsächlich! Jetzt ist der Zusammenhang *innerhalb jeder Gruppe* (Spezies) *POSITIV*.\n\n\nDas bedeutet: Wenn wir die Spezies berücksichtigen, dann ist der Zusammenhang zwischen Schnabeltiefe und Gewicht *positiv*.\n\nDiesen Vorzeichenwechsel nennt man \"Simpson-Paradox\".\n\n\n\n### Fazit: Welches Modell ist jetzt richtig?\n\n\nDa sich die Effekte komplett widersprechen (negativ vs. positiver Zusammenhang) stellt sich die Frage:\nWelchem Modell - Modell 1 oder Modell 2 - glauben wir jetzt?\n\nDie Antwort ist ein klares: Kommt drauf an.\nKommt drauf an, welcher Theorie zum kausalen Zusammenhang der betreffenden Variablen wir glauben.\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}