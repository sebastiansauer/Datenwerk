---
exname: iq10
extype: num
exsolution: 0.5
exshuffle: no
extol: 0.03
expoints: 1
categories:
- probability
- simulation
- normal-distribution
- bayes
- bayes-box
date: '2022-11-11'
slug: iq10
title: iq10

---






```{r global-knitr-options, include=FALSE}
knitr::opts_chunk$set(fig.pos = 'H',
                      fig.asp = 0.618,
                      fig.width = 4,
                      fig.cap = "", 
                      fig.path = "",
                      echo = TRUE, 
                      message = FALSE,
                      fig.show = "hold")
```







# Exercise

Eine Forscherin, Prof. Weiss-Ois, untersucht den Effekt von Cannabis auf die Intelligenz.

Dazu untersucht Sie die Intelligenz langjähriger Konsumentis.

Prof. Weiss-Ois geht apriori von gleichverteilter Intelligenz. 
Ihre zentrale Hypothese ist $\mu = 90\pm5$.
 

Mit großer Spannung wurden die Messdaten zur Intelligenz erwartet (die erst nach langem Streit über die zu verwendenden Intelligenztests erhoben werden konnten).
Insgesamt wurden $N=541$ Personen untersucht.


Tatsächlich sei die wahre IQ-Verteilung jener Cannabis-Konsumentis wie folgt: $IQ \sim N(92.5, 7.5)$. 
Natürlich kennt die Forscherin diese Verteilung nicht.

*Wie wahrscheinlich ist die Hypothese der Forscherin im Lichte der Daten?*



Hinweise:

- Nutzen Sie Simulationsmethoden.
- Geben Sie Anteile oder Wahrscheinlichkeiten stets mit zwei Dezimalstellen an (sofern nicht anders verlangt).
- Simulieren Sie $n=10^4$ Stichproben.
- Nutzen Sie die Zahl 42 als Startwert für Ihre Zufallszahlen (um die Reproduzierbarkeit zu gewährleisten).


</br>
</br>
</br>
</br>
</br>
</br>
</br>
</br>
</br>
</br>

# Solution

```{r}
library(tidyverse)
```


Simulieren wir uns die Stichprobe:

```{r}
set.seed(42)
stipro <-
  tibble(iq = rnorm(n = 541, mean = 92.5, sd = 7.5))
```


Jetzt basteln wir die Bayes-Box:

```{r}
n <- 100

set.seed(42)
postvert <-
  tibble(p_grid = seq(from = 75, to = 130, length.out = n),
         prior  = 1) %>% 
  mutate(likelihood = dnorm(x = p_grid, mean = 92.5, sd = 7.5)) %>% 
  mutate(unstand_post = (likelihood * prior),
         post = unstand_post / sum(unstand_post))
```


Daraus ziehen wir Stichproben:

```{r}
set.seed(42)
postvert_stipros <-
  postvert %>% 
  slice_sample(
    n = 1e4,
    weight_by = post,
    replace = T) %>% 
  select(p_grid)
  
```

Da `slice_sample` auch zufällig Stichproben zieht,
müssen wir auch hier die Zufallszahlen fixieren, wenn
wir die exakt gleichen Ergebnisse reproduzieren wollen.


Jetzt schauen wir (mit Spannung), wie hoch die Wahrscheinlichkeit ist für Parameterwete (`p_grid`) innerhalb des Intervalls wie von der Forscherin vorgegeben.

```{r}
postvert_stipros %>% 
  count(between(p_grid, left = 85, right = 95))
```


`between` ist eine Komfortfuntion; ins Deutsche übersetzt sagt die Syntax:

```
Nimm die Tabelle postvert_stipros und dann ...
  zähle den Anteil der Werte von p_grid zwischen 85 und 95.
```

Die Wahrscheinlichkeit der Hypothese der Forscherin beträgt ca. 50%.

Ob das viel oder weniger ist, ist eine subjektive Frage.
Das beste Vorgehen wäre jetzt, die Hypothesen anderer Forschis dagegen zu legen.
Dann würde man sehen, welche Hypothese am besten zu den Daten passt.





---

Categories: 

- probability
- simulation
- normal-distribution
- bayes
- bayes-grid


